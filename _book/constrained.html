<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>15&nbsp; Constrained Multidimensional Scaling – Least Squares Euclidean Multidimensional Scaling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./individual.html" rel="next">
<link href="./unfolding.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head><body class="nav-sidebar floating">.greybox {
  padding: 1em;
  background: white;
  color: black;
  border: 2px solid orange;
  border-radius: 10px;
}
.center {
  text-align: center;
}

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>





<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./constrained.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Constrained Multidimensional Scaling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Least Squares Euclidean Multidimensional Scaling</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Note</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notation and Reserved Symbols</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./properties.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Properties of Stress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stress Spaces</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./minimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Minimization of Basic Stress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acceleration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Acceleration of Convergence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonmetric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Nonmetric MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Interval MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./polynomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Polynomial MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ordinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Ordinal MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./splinical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Splinical MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unidimensional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Unidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./full.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Full-dimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unfolding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Unfolding</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./constrained.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Constrained Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./individual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Individual Differences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./asymmetry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Asymmetry in MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nominal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Nominal MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonordinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Nonmonotonic MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonpairs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Compound Objects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sstress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">sstress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rstress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">fstress and rstress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./altls.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Alternative Least Squares Loss</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Inverse Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Stability of MDS Solutions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./global.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">In Search of Global Minima</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Software</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./backmatter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(APPENDIX) Appendices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#primal-dual-note-the-base-partitioning-has-dual-aspects" id="toc-primal-dual-note-the-base-partitioning-has-dual-aspects" class="nav-link active" data-scroll-target="#primal-dual-note-the-base-partitioning-has-dual-aspects"><span class="header-section-number">15.1</span> Primal-Dual (note: the base partitioning has dual aspects)</a></li>
  <li><a href="#baspar" id="toc-baspar" class="nav-link" data-scroll-target="#baspar"><span class="header-section-number">15.2</span> Basic Partitioning</a></li>
  <li><a href="#majawa" id="toc-majawa" class="nav-link" data-scroll-target="#majawa"><span class="header-section-number">15.3</span> Unweigthing</a></li>
  <li><a href="#constraints-on-the-distances" id="toc-constraints-on-the-distances" class="nav-link" data-scroll-target="#constraints-on-the-distances"><span class="header-section-number">15.4</span> Constraints on the Distances</a>
  <ul class="collapse">
  <li><a href="#rectangles" id="toc-rectangles" class="nav-link" data-scroll-target="#rectangles"><span class="header-section-number">15.4.1</span> Rectangles</a></li>
  </ul></li>
  <li><a href="#lincons" id="toc-lincons" class="nav-link" data-scroll-target="#lincons"><span class="header-section-number">15.5</span> Linear Constraints</a>
  <ul class="collapse">
  <li><a href="#uniqueness" id="toc-uniqueness" class="nav-link" data-scroll-target="#uniqueness"><span class="header-section-number">15.5.1</span> Uniqueness</a></li>
  <li><a href="#combinations" id="toc-combinations" class="nav-link" data-scroll-target="#combinations"><span class="header-section-number">15.5.2</span> Combinations</a></li>
  <li><a href="#stepsize" id="toc-stepsize" class="nav-link" data-scroll-target="#stepsize"><span class="header-section-number">15.5.3</span> Step Size</a></li>
  <li><a href="#singdesign" id="toc-singdesign" class="nav-link" data-scroll-target="#singdesign"><span class="header-section-number">15.5.4</span> Single Design Matrix</a></li>
  <li><a href="#multdesign" id="toc-multdesign" class="nav-link" data-scroll-target="#multdesign"><span class="header-section-number">15.5.5</span> Multiple Design Matrices</a></li>
  </ul></li>
  <li><a href="#circmds" id="toc-circmds" class="nav-link" data-scroll-target="#circmds"><span class="header-section-number">15.6</span> Circular MDS</a>
  <ul class="collapse">
  <li><a href="#circhist" id="toc-circhist" class="nav-link" data-scroll-target="#circhist"><span class="header-section-number">15.6.1</span> Some History</a></li>
  <li><a href="#circprimal" id="toc-circprimal" class="nav-link" data-scroll-target="#circprimal"><span class="header-section-number">15.6.2</span> Primal Methods</a></li>
  <li><a href="#circdual" id="toc-circdual" class="nav-link" data-scroll-target="#circdual"><span class="header-section-number">15.6.3</span> Dual Methods</a></li>
  </ul></li>
  <li><a href="#ellimcds" id="toc-ellimcds" class="nav-link" data-scroll-target="#ellimcds"><span class="header-section-number">15.7</span> Elliptical MDS</a>
  <ul class="collapse">
  <li><a href="#elliprimal" id="toc-elliprimal" class="nav-link" data-scroll-target="#elliprimal"><span class="header-section-number">15.7.1</span> Primal</a></li>
  <li><a href="#ellidual" id="toc-ellidual" class="nav-link" data-scroll-target="#ellidual"><span class="header-section-number">15.7.2</span> Dual</a></li>
  </ul></li>
  <li><a href="#distance-bounds" id="toc-distance-bounds" class="nav-link" data-scroll-target="#distance-bounds"><span class="header-section-number">15.8</span> Distance Bounds</a></li>
  <li><a href="#localized-mds" id="toc-localized-mds" class="nav-link" data-scroll-target="#localized-mds"><span class="header-section-number">15.9</span> Localized MDS</a></li>
  <li><a href="#mds-as-mva" id="toc-mds-as-mva" class="nav-link" data-scroll-target="#mds-as-mva"><span class="header-section-number">15.10</span> MDS as MVA</a></li>
  <li><a href="#conshorseshoes" id="toc-conshorseshoes" class="nav-link" data-scroll-target="#conshorseshoes"><span class="header-section-number">15.11</span> Horseshoes</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="cmds" class="quarto-section-identifier"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Constrained Multidimensional Scaling</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>As we have seen in section @ref(introgeneralize) Constrained Multidimensional Scaling or CMDS is defined as the generalization of basic MDS in which we want to solve <span class="math display">\[
\min_{X\in\Omega}\ \mathop{\sum\sum}_{1\leq i&lt;j\leq n}w_{ij}(\delta_{ij}-d_{ij}(X))^2,
\]</span> where <span class="math inline">\(\Omega\)</span> is a subset of <span class="math inline">\(\mathbb{R}^{n\times p}\)</span>. Of course there are also versions of CMDS in which the dissimilarities are nonmetric and must be quantified or transformed accordingly. But in this chapter we concentrate on the ways in which we constrain the configuration and on the ways to incorporate this into the smacof framework.</p>
<p>Constraints on <span class="math inline">\(X\)</span> can be defined in many different ways. They can be in <em>parametric form</em>, using a map <span class="math inline">\(F:\Theta\Rightarrow\mathbb{R}^{n\times p}\)</span>. Thus the constraints are <span class="math inline">\(X=F(\theta)\)</span> and <span class="math inline">\(\theta\)</span> varies in some subset <span class="math inline">\(\Theta\)</span> of real parameter space. Alternatively we can have constraints in <em>dual form</em>, i.e, have a maps&nbsp;<span class="math inline">\(F\)</span> on <span class="math inline">\(\mathbb{R}^{n\times p}\)</span> and define <span class="math inline">\(\Omega\)</span> by <span class="math inline">\(F(X)=0\)</span> (or <span class="math inline">\(F_1(X)=0\)</span> and <span class="math inline">\(F_2(X)\geq 0\)</span>). If <span class="math inline">\(F\)</span> is smooth both parametric and dual forms define manifolds in <span class="math inline">\(\mathbb{R}^{n\times p}\)</span>, and often constraints can be equivalently expressed in both forms. Requiring the points in the configuration to be on the unit circle, for example, has the parametric form <span class="math inline">\(x_i=(\sin\theta_i,\cos\theta_i)\)</span> and the dual form <span class="math inline">\(\|x_i\|^2=1\)</span>.</p>
<p>Bentler-Weeks</p>
<p><span class="math display">\[
\mathop{\sum\sum}_{1\leq i&lt;j\leq n}w_{ij}(\delta_{ij}-(\alpha\  d_{ij}(X)+\beta))^2.
\]</span> with <span class="math inline">\(x_{is}=K\)</span> or <span class="math inline">\(x_{is}=wy_{is}\)</span> for some set of <span class="math inline">\((i,s)\)</span>.</p>
<p>Configuration-Distances <span class="math inline">\(F(D(X))\geq 0\)</span> and <span class="math inline">\(G(D(X))=0\)</span> Borg-Lingoes</p>
<p><span class="math display">\[
\min_{D\in\mathcal{D}}\ \mathop{\sum\sum}_{1\leq i&lt;j\leq n}w_{ij}(\delta_{ij}-d_{ij})^2,
\]</span></p>
<p>De Leeuw-Heiser</p>
<section id="primal-dual-note-the-base-partitioning-has-dual-aspects" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="primal-dual-note-the-base-partitioning-has-dual-aspects"><span class="header-section-number">15.1</span> Primal-Dual (note: the base partitioning has dual aspects)</h2>
<p>Least squares</p>
<p><span class="math display">\[
\sigma_\lambda(X):=\sigma(X)+\lambda\min_{Y\in\Omega}\eta^2(X-Y)
\]</span> <span class="math display">\[
\sigma_\lambda(X):=\sigma(X)+\lambda\min_{\Delta\in\mathcal{D}}\mathop{\sum\sum}_{1\leq i&lt;j\leq n}w_{ij}(\delta_{ij}-d_{ij}(X)^2
\]</span></p>
</section>
<section id="baspar" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="baspar"><span class="header-section-number">15.2</span> Basic Partitioning</h2>
<p>A comprehensive smacof approach to constrained MDS was developed in <span class="citation" data-cites="deleeuw_heiser_C_80">De Leeuw and Heiser (<a href="references.html#ref-deleeuw_heiser_C_80" role="doc-biblioref">1980</a>)</span>. It is a primal method that does not involve penalty parameters, and it defines the constraints directly on the configuration.</p>
<p>The starting point is the <em>majorization partitioning</em> <span class="math display">\[\begin{equation}
\sigma(X)\leq 1+\eta^2(X-\gamma(Y))-\eta^2(\gamma(Y)),
(\#eq:smacmdsis)
\end{equation}\]</span> with equality, of course, if <span class="math inline">\(X=Y\)</span>.</p>
<p>Note similarity with dual approach</p>
<p>The smacof algorithm for constrained MDS has consequently two steps. In the first we compute the Guttman transform of the current configuration, and in the second we find the metric projection of this Guttman transform on the constraint set (in the metric defined by <span class="math inline">\(V\)</span>). Thus, in shorthand,</p>
<p><span class="math display">\[\begin{equation}
X^{(k+1)}\in\mathop{\text{Argmin}}_{Y\in\Omega}\ \eta^2 (Y-\Gamma(X^{(k)})).
(\#eq:smacmds)
\end{equation}\]</span></p>
<p>To emphasize we look for a fixed point of the composition of two maps, the Guttman transform and the projection operator <span class="math inline">\(\Pi_\Omega\)</span>, we can write in even shorter hand</p>
<p><span class="math display">\[
X^{(k+1)}\in\Pi_\Omega(\Gamma(X^{(k)}))
\]</span></p>
<p>The smacof formulation of the CMDS problem is elegant, if I say so myself, but it is not always simple from the computational point of view. The Guttman transform is easy enough to compute, but projecting on <span class="math inline">\(\Omega\)</span> in the <span class="math inline">\(V\)</span> metric may be complicated, depending on how <span class="math inline">\(\Omega\)</span> is defined. In this chapter we will discuss a number of examples with varying degrees of difficulty in computing the <em>smacof projection</em>.</p>
</section>
<section id="majawa" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="majawa"><span class="header-section-number">15.3</span> Unweigthing</h2>
<p>For some types of constraints, for example the circular and elliptical MDS discussed in section @ref(circmds), unweighted least squares is computationally simpler than weighted least squares. In those cases it generally pays to use majorization to go from a weighted to an unweighted problem (see also <span class="citation" data-cites="groenen_giaquinto_kiers_03">Groenen, Giaquinto, and Kiers (<a href="references.html#ref-groenen_giaquinto_kiers_03" role="doc-biblioref">2003</a>)</span>). This will tend to increase the number of iterations of smacof, but the computation within each iteration will be considerably faster.</p>
<p>From equation @ref(eq:smacmds), the projection problem in constrained MDS is to minimize the weighted least squares loss function <span class="math inline">\(\phi(X):=\text{tr}\ (Z-X)'V(Z-X)\)</span> over <span class="math inline">\(X\in\Omega\)</span>. Now suppose <span class="math inline">\(\theta\)</span> is the largest eigenvalue of <span class="math inline">\(V\)</span>, so that <span class="math inline">\(V\lesssim\theta I\)</span>, and suppose <span class="math inline">\(Y\in\Omega\)</span>. Then</p>
<p><span class="math display">\[\begin{multline}
\phi(X)=\text{tr}\ ((Z-Y)-(X-Y))'V((Z-Y)-(X-Y))\leq\\\phi(Y)-2\ \text{tr}\ (Z-Y)'V(X-Y)+\theta\ \text{tr}\ (X-Y)'(X-Y).
(\#eq:majproj)
\end{multline}\]</span></p>
<p>Completing the square gives the majorization</p>
<p><span class="math display">\[\begin{equation}
\phi(X)\leq\phi(Y)+\theta\ \text{tr}\ (X-\overline{Y})'(X-\overline{Y})-\theta\ \text{tr}\ \overline{Y}'\overline{Y},
(\#eq:compsqproj)
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\overline{Y}\)</span> the matrix-convex combination</p>
<p><span class="math display">\[\begin{equation}
\overline{Y}:=(I-\frac{1}{\theta}V)Y+\frac{1}{\theta}VZ.
(\#eq:projtarget)
\end{equation}\]</span></p>
<p>The weighted projection problem from equation @ref(eq:smacmds) is replaced by one or more inner iterations of an unweighted projection problem. Set <span class="math inline">\(X^{(k,1)}=X^{(k)}\)</span> and</p>
<p><span class="math display">\[\begin{equation}
X^{(k,l+1)}\in\mathop{\text{Argmin}}_{Y\in\Omega}\ \text{tr}\ (Y-\overline{X}^{k,l})'(Y-\overline{X}^{(k,l)}).
(\#eq:smaprojinner)
\end{equation}\]</span></p>
<p>After stopping the inner iterations at <span class="math inline">\(X^{(k,l+s)}\)</span> we set <span class="math inline">\(X^{(k+1)}=X^{(k,l+s)}\)</span>. All <span class="math inline">\(X^{(k,l)}\)</span> remain feasible, loss decreases in each inner iteration, and as long at the metric projections are continuous the map from <span class="math inline">\(X^{(k)}\)</span> to <span class="math inline">\(X^{(k+1)}\)</span> is continuous as well.</p>
</section>
<section id="constraints-on-the-distances" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="constraints-on-the-distances"><span class="header-section-number">15.4</span> Constraints on the Distances</h2>
<section id="rectangles" class="level3" data-number="15.4.1">
<h3 data-number="15.4.1" class="anchored" data-anchor-id="rectangles"><span class="header-section-number">15.4.1</span> Rectangles</h3>
</section>
</section>
<section id="lincons" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="lincons"><span class="header-section-number">15.5</span> Linear Constraints</h2>
<section id="uniqueness" class="level3" data-number="15.5.1">
<h3 data-number="15.5.1" class="anchored" data-anchor-id="uniqueness"><span class="header-section-number">15.5.1</span> Uniqueness</h3>
<p><span class="math inline">\(X=(Z\mid D)\)</span></p>
<p><span class="math inline">\(X=(Z\mid \alpha I)\)</span></p>
<p>Distance smoothing</p>
</section>
<section id="combinations" class="level3" data-number="15.5.2">
<h3 data-number="15.5.2" class="anchored" data-anchor-id="combinations"><span class="header-section-number">15.5.2</span> Combinations</h3>
<p><span class="math inline">\(X=\sum\alpha_r Z_r\)</span></p>
</section>
<section id="stepsize" class="level3" data-number="15.5.3">
<h3 data-number="15.5.3" class="anchored" data-anchor-id="stepsize"><span class="header-section-number">15.5.3</span> Step Size</h3>
<p><span class="math inline">\(X=Z+\alpha G\)</span></p>
</section>
<section id="singdesign" class="level3" data-number="15.5.4">
<h3 data-number="15.5.4" class="anchored" data-anchor-id="singdesign"><span class="header-section-number">15.5.4</span> Single Design Matrix</h3>
<p><span class="math inline">\(X=ZU\)</span></p>
</section>
<section id="multdesign" class="level3" data-number="15.5.5">
<h3 data-number="15.5.5" class="anchored" data-anchor-id="multdesign"><span class="header-section-number">15.5.5</span> Multiple Design Matrices</h3>
<p><span class="math inline">\(x_s=G_su_s\)</span></p>
<p><span class="math display">\[
d_{ij}^2(X)=\sum_{s=1}^p x_s'A_{ij}x_s=
\sum_{s=1}^p u_s'G_s'A_{ij}G_su_s
\]</span></p>
</section>
</section>
<section id="circmds" class="level2" data-number="15.6">
<h2 data-number="15.6" class="anchored" data-anchor-id="circmds"><span class="header-section-number">15.6</span> Circular MDS</h2>
<p><span class="citation" data-cites="deleeuw_U_07h">De Leeuw (<a href="references.html#ref-deleeuw_U_07h" role="doc-biblioref">2007b</a>)</span>, <span class="citation" data-cites="deleeuw_R_07a">De Leeuw (<a href="references.html#ref-deleeuw_R_07a" role="doc-biblioref">2007a</a>)</span>, <span class="citation" data-cites="deleeuw_U_05j">De Leeuw (<a href="references.html#ref-deleeuw_U_05j" role="doc-biblioref">2005</a>)</span></p>
<p>There are situations in which it is desirable to have a configuration with points that are restricted to lie on some surface or manifold in <span class="math inline">\(\mathbb{R}^p\)</span>. Simple examples are the circle in <span class="math inline">\(\mathbb{R}^2\)</span> or the sphere in <span class="math inline">\(\mathbb{R}^3\)</span>. Some applications are discussed in <span class="citation" data-cites="cox_cox_91">Cox and Cox (<a href="references.html#ref-cox_cox_91" role="doc-biblioref">1991</a>)</span> (also see <span class="citation" data-cites="cox_cox_01">Cox and Cox (<a href="references.html#ref-cox_cox_01" role="doc-biblioref">2001</a>)</span>, section 4.6), in <span class="citation" data-cites="borg_lingoes_80">Borg and Lingoes (<a href="references.html#ref-borg_lingoes_80" role="doc-biblioref">1980</a>)</span>, in <span class="citation" data-cites="papazoglou_mylonas_17">Papazoglou and Mylonas (<a href="references.html#ref-papazoglou_mylonas_17" role="doc-biblioref">2017</a>)</span>, and in <span class="citation" data-cites="deleeuw_mair_A_09c">De Leeuw and Mair (<a href="references.html#ref-deleeuw_mair_A_09c" role="doc-biblioref">2009</a>)</span>, section 5. The most prominent actual examples are probably the color circle and the spherical surface of the earth, but there are many other cases in which MDS solutions show some sort of “horseshoe” (<span class="citation" data-cites="deleeuw_R_07a">De Leeuw (<a href="references.html#ref-deleeuw_R_07a" role="doc-biblioref">2007a</a>)</span>).</p>
<section id="circhist" class="level3" data-number="15.6.1">
<h3 data-number="15.6.1" class="anchored" data-anchor-id="circhist"><span class="header-section-number">15.6.1</span> Some History</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="graphics/johnvdg.jpeg" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>John van de Geer</figcaption>
</figure>
</div>
</div>
</div>
<p>Permit me to insert some personal history here. Around 1965 I got to work at the Psychological Institute. At the time Experimental Psychology and Methodology were in the same department, with John van de Geer as its chair. John had a long-running project with Pim Levelt and Reinier Plomp at the Institute for Perception RVO/TNO on perceptual and cognitive aspects of musical intervals. In <span class="citation" data-cites="vandegeer_levelt_plomp_62">Van de Geer, Levelt, and Plomp (<a href="references.html#ref-vandegeer_levelt_plomp_62" role="doc-biblioref">1962</a>)</span>, for example, they used various cutting-edge techniques at the time, the semantic differential for data collection, the centroid method for factor analysis, and oblique simple structure rotation. A couple of years later the cutting edge had moved to triadic comparisons for data collection and nonmetric multidimensional scaling (<span class="citation" data-cites="levelt_vandegeer_plomp_66">Levelt, Van De Geer, and Plomp (<a href="references.html#ref-levelt_vandegeer_plomp_66" role="doc-biblioref">1966</a>)</span>). The analysis in <span class="citation" data-cites="levelt_vandegeer_plomp_66">Levelt, Van De Geer, and Plomp (<a href="references.html#ref-levelt_vandegeer_plomp_66" role="doc-biblioref">1966</a>)</span> revealed a parabolic horseshoe structure of the musical intervals.</p>
<p>This inspired John to find a technique to fit quadratic (and higher order, if necessary) structures to scatterplots. If <span class="math inline">\(X\)</span> is a two-dimensional configuration of <span class="math inline">\(n\)</span> points, then form the <span class="math inline">\(n\times 6\)</span> matrix <span class="math inline">\(Z\)</span> with columns <span class="math inline">\(1,x_1,x_2,x_i^2,x_2^2,x_1x_2\)</span>. Now find <span class="math inline">\(\alpha\)</span> with <span class="math inline">\(\alpha'\alpha=1\)</span> such that <span class="math inline">\(\alpha'Z'Z\alpha\)</span> is as small as possible. This gives the normalized eigenvector corresponding with the smallest eigenvalue of <span class="math inline">\(Z'Z\)</span>, or, equivalently, the right singular vector corresponding with the smallest singular value of <span class="math inline">\(Z\)</span>. It is easy to see how this approach generalizes to more dimensions and higher order algebraic surfaces. I remember with how much awe this technique was received by the staff of the Psychological Institute. It probably motivated me in 1966 to develop similar techniques and get my portion of awe.</p>
<p><span class="citation" data-cites="levelt_vandegeer_plomp_66">Levelt, Van De Geer, and Plomp (<a href="references.html#ref-levelt_vandegeer_plomp_66" role="doc-biblioref">1966</a>)</span> used the curve fitting technique to draw the best fitting parabola in the two-dimensional scatterplot of musical intervals. In their discussion they suggested that a similar quadratic structure could be found if similarities between political parties were analyzed, because for people in the middle of the left-right scale extreme-left and extreme-right parties would tend to be similar. If the effect of extremity was strong enough, the two extreme might even bend towards each other, leading to an ellipse rather than a parabola. In 1966 John asked student-researcher Dato de Gruijter to figure out if this curving back actually happened, which lead to <span class="citation" data-cites="degruijter_67">De Gruijter (<a href="references.html#ref-degruijter_67" role="doc-biblioref">1967</a>)</span>. Dato collected triadic comparisons between nine Dutch political parties, cumulated over 100 psychology students. The curve fitting technique indeed found best fitting ellipses.</p>
</section>
<section id="circprimal" class="level3" data-number="15.6.2">
<h3 data-number="15.6.2" class="anchored" data-anchor-id="circprimal"><span class="header-section-number">15.6.2</span> Primal Methods</h3>
<p>We follow <span class="citation" data-cites="deleeuw_mair_A_09c">De Leeuw and Mair (<a href="references.html#ref-deleeuw_mair_A_09c" role="doc-biblioref">2009</a>)</span> in distinguishing <em>primal</em> and <em>dual</em> methods. In a primal method the surface we fit is specified in parametric form. The points on the circle, for example, have <span class="math inline">\((x_{i1},x_{i2})=(sin(\xi_i),cos(\xi_i))\)</span>. Rotational invariance of MDS means we can assume the center of the circle is in the origin. This is the approach of <span class="citation" data-cites="cox_cox_91">Cox and Cox (<a href="references.html#ref-cox_cox_91" role="doc-biblioref">1991</a>)</span>. They substitute the parametrix expression for the circle in the formula for stress and minimize over the sperical coordinates <span class="math inline">\(\xi_i\)</span> using gradient methods. They develop a similar method for the sphere in <span class="math inline">\(\mathbb{R}^3\)</span>. For those who want to go to higher dimensions we illustrate a parametric representation for <span class="math inline">\(\mathbb{R}^4\)</span>. <span class="math display">\[
(x_{i1},x_{i2},x_{i3},x_{i4})=\\(\sin(\xi_i)\cos(\theta_i)\sin(\mu_i),\
\sin(\xi_i)\cos(\theta_i)\cos(\mu_i),\ \sin(\xi_i)\sin(\theta_i),\ \cos(\xi_i)).
\]</span> Spherical coordinates soon get tedious, and <span class="citation" data-cites="deleeuw_mair_A_09c">De Leeuw and Mair (<a href="references.html#ref-deleeuw_mair_A_09c" role="doc-biblioref">2009</a>)</span> simply require the distances of all points to the origin to be the same constant. Note that this puts the center of the fitted sphere in the origin, which means that in general the center of the point cloud cannot be taken to be in the origin as well. In smacof we use the</p>
<p><span class="math display">\[
\phi(X,\lambda):=\text{tr}\ (Z-\lambda X)'V(Z-\lambda X)
\]</span> over the radius <span class="math inline">\(\lambda\)</span> and the configuration <span class="math inline">\(X\)</span>, which is constrained to have <span class="math inline">\(\text{diag}\ XX'=I\)</span>. <span class="citation" data-cites="deleeuw_mair_A_09c">De Leeuw and Mair (<a href="references.html#ref-deleeuw_mair_A_09c" role="doc-biblioref">2009</a>)</span> project out <span class="math inline">\(\lambda\)</span> and minimize <span class="math inline">\(\phi(X,\star):=\min_\lambda\phi(X,\lambda)\)</span> over <span class="math inline">\(X\)</span>, using Dinkelbach majorization (<span class="citation" data-cites="dinkelbach_67">Dinkelbach (<a href="references.html#ref-dinkelbach_67" role="doc-biblioref">1967</a>)</span>), a block relaxation that cycles over rows of <span class="math inline">\(X\)</span>. Solving for each <span class="math inline">\(p\)</span> vector of coordinates requires solving a secular equation.</p>
<p>Here we proceed slightly differently. Our first step is to get rid of <span class="math inline">\(V\)</span> using the formulas in @ref(majawa).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="constrained_files/figure-html/ekcircpnts-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>After 2 iterations the primal method converges to a stress value of 0.4654367. The circle has radius 0.0122974.</p>
</section>
<section id="circdual" class="level3" data-number="15.6.3">
<h3 data-number="15.6.3" class="anchored" data-anchor-id="circdual"><span class="header-section-number">15.6.3</span> Dual Methods</h3>
<p>In a dual method we use unrestricted smacof, but we add a penalty to the loss if the configurations do not satisfy the constraints. We use a quadratic penalty, mainly because that fits seamlessly into the smacof approach.</p>
<p>We add one point, the center of the circle, with coordinates <span class="math inline">\(x_0\)</span> to the configuration, and we require that all <span class="math inline">\(n\)</span> other points have an equal distance from the center. The <span class="math inline">\(n\)</span> dissimilarities <span class="math inline">\(\delta_{0,i}\)</span> are unknown, so we use alternating least squares and estimate the missing dissimilarities by minimizing stress over them, requiring them to be all equal. All weights <span class="math inline">\(w_{0,i}\)</span> are chosen equal to the penalty parameter <span class="math inline">\(\omega\)</span>. The solution for the common <span class="math inline">\(\delta_{0,i}\)</span> is obviously the average of the <span class="math inline">\(n\)</span> distances <span class="math inline">\(d_{0,i}\)</span>. In this case it is not necessary to use majorization to transform to unweighted least squares.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="constrained_files/figure-html/plcircpnts-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ellimcds" class="level2" data-number="15.7">
<h2 data-number="15.7" class="anchored" data-anchor-id="ellimcds"><span class="header-section-number">15.7</span> Elliptical MDS</h2>
<section id="elliprimal" class="level3" data-number="15.7.1">
<h3 data-number="15.7.1" class="anchored" data-anchor-id="elliprimal"><span class="header-section-number">15.7.1</span> Primal</h3>
<p>The smacof projection problem for a <span class="math inline">\(p\)</span>-axial ellipsoid minimizes <span class="math display">\[
\phi(Y,\Lambda):=\text{tr}\ (Z-Y\Lambda)'V(Z-Y\Lambda)
\]</span> with <span class="math inline">\(\text{diag}\ YY'=I\)</span> and with <span class="math inline">\(\Lambda\)</span> diagonal and PSD.</p>
<p>ALS</p>
<p>Minimizing <span class="math inline">\(\phi\)</span> over <span class="math inline">\(\Lambda\)</span> for fixed <span class="math inline">\(Y\)</span> is easy. For dimension <span class="math inline">\(s\)</span> we have</p>
<p><span class="math display">\[
\lambda_s=\frac{y_s'Vz_s}{y_s'Vy_s}.
\]</span></p>
<p>To minimize <span class="math inline">\(\phi\)</span> over <span class="math inline">\(Y\)</span> for fixed <span class="math inline">\(\Lambda\)</span> we use <span class="math inline">\(Z-Y\Lambda=(Z\Lambda^{-1}-Y)\Lambda\)</span> so that</p>
<p><span class="math display">\[
\phi(Y,\Lambda)=\text{tr}\ \Lambda^2(\tilde Z-Y)'V(\tilde Z-Y)
\]</span> with <span class="math inline">\(\tilde Z=Z\Lambda^{-1}\)</span>. We now use a slight modification of the majorization technique in section @ref(majawa). Set <span class="math inline">\(Y=Y_{\text{old}}+(Y-Y_{\text{old}})\)</span>. Then <span class="math display">\[
\phi(Y,\Lambda)=\text{tr}\ \Lambda^2((\tilde Z-Y_{\text{old}})-(Y-Y_{\text{old}}))'V((\tilde Z-Y_{\text{old}})-(Y-Y_{\text{old}}))=\\
\phi(Y_{\text{old}},\Lambda)-2\ \text{tr}\ \Lambda^2(\tilde Z-Y_{\text{old}})'V(Y-Y_{\text{old}})+\text{tr}\ \Lambda^2(Y-Y_{\text{old}})'V(Y-Y_{\text{old}})
\]</span></p>
<p><span class="math display">\[
\text{tr}\ \Lambda^2(Y-Y_{\text{old}})'V(Y-Y_{\text{old}})\leq
\theta\lambda_{\text{max}}^2\ \text{tr}\ (Y-Y_{\text{old}})'(Y-Y_{\text{old}})
\]</span></p>
<p>where, as before, <span class="math inline">\(\theta\)</span> is the largest eigenvalue of <span class="math inline">\(V\)</span>.</p>
<p><span class="math display">\[
\theta\lambda_{\text{max}}^2\ (Y-Y_{\text{old}})=V(\tilde Z - Y_{\text{old}})\Lambda^2
\]</span> (abadir_magnus_05, p 283)</p>
<p>Normalize the rows of</p>
<p><span class="math display">\[
Y_{\text{old}}+\frac{1}{\theta\lambda_{\text{max}}^2}V(Z\Lambda^{-1}-Y_{\text{old}})\Lambda^2
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="constrained_files/figure-html/ekellikpnts-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>0.0053277, 0.0095667</p>
<p>2</p>
<p>0.415335</p>
</section>
<section id="ellidual" class="level3" data-number="15.7.2">
<h3 data-number="15.7.2" class="anchored" data-anchor-id="ellidual"><span class="header-section-number">15.7.2</span> Dual</h3>
<p>We will only develop a dual method for ellipses in two dimensions, because there is no easy characterization in terms of distances in higher dimensions (that I know of). But in two dimensions the famous pin-and-string construction uses the fact that for all points on the ellipse the sum of the distances to two focal points is constant. Thus our dual method now adds two points to the <span class="math inline">\(n\)</span> points in the configuration, chooses the weights for the <span class="math inline">\(2n\)</span> components of stress to be the penalty parameter w, and finds the <span class="math inline">\(2n\)</span> unknown dissimilarities between the two focal points and the <span class="math inline">\(n\)</span> points on the ellipse to add up to a constant.</p>
<p>This means we have to minimize <span class="math inline">\(\text{tr}\ (\Delta-D)'(\Delta-D)\)</span> over <span class="math inline">\(\Delta\)</span> satisfying <span class="math inline">\(\Delta e=\gamma e\)</span>, where for the time being <span class="math inline">\(\Delta\)</span> and <span class="math inline">\(D\)</span> are <span class="math inline">\(n\times 2\)</span> submatrices. The Lagrangian is <span class="math inline">\(\text{tr}\ (\Delta-D)'(\Delta-D)-2\mu'(\Delta e-\gamma e)\)</span>, and thus we must have <span class="math inline">\(\Delta=D+\mu e'\)</span>. Taking row sums gives <span class="math inline">\(\gamma e = De+p\mu\)</span> and thus <span class="math inline">\(\mu = \frac12(\gamma e-De)\)</span>. This implies <span class="math inline">\(\Delta-D=\mu e'=\frac{1}{2}(\gamma E_{np}-DE_{pp}),\)</span> and to minimize loss over <span class="math inline">\(\gamma\)</span> we choose <span class="math inline">\(\gamma=\frac{1}{n}e_n'De_p\)</span>. This gives <span class="math display">\[
\Delta=DJ+\frac{e'De}{2n}ee'.
\]</span> Thus we take <span class="math inline">\(D\)</span>, transform its <span class="math inline">\(n\)</span> rows to deviations from the mean, and then add the overall mean to all elements.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="constrained_files/figure-html/plpnts-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="constrained_files/figure-html/plellip-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>hyperbola: difference of distances constant <span class="math inline">\(|d((x_i,x_2),(f_1,0))-d((x_i,x_2),(g_1,0))|=c\)</span></p>
<p>parabola: equal distance from the focus point and the directrix (horizontal axis) <span class="math inline">\(d((x_i,x_2),(f_1,f_2))=d((x_1,x_2),d(x_1,0))\)</span></p>
</section>
</section>
<section id="distance-bounds" class="level2" data-number="15.8">
<h2 data-number="15.8" class="anchored" data-anchor-id="distance-bounds"><span class="header-section-number">15.8</span> Distance Bounds</h2>
<p><span class="citation" data-cites="deleeuw_E_17b">De Leeuw (<a href="references.html#ref-deleeuw_E_17b" role="doc-biblioref">2017c</a>)</span> <span class="citation" data-cites="deleeuw_E_17c">De Leeuw (<a href="references.html#ref-deleeuw_E_17c" role="doc-biblioref">2017b</a>)</span> <span class="citation" data-cites="deleeuw_E_17d">De Leeuw (<a href="references.html#ref-deleeuw_E_17d" role="doc-biblioref">2017a</a>)</span></p>
</section>
<section id="localized-mds" class="level2" data-number="15.9">
<h2 data-number="15.9" class="anchored" data-anchor-id="localized-mds"><span class="header-section-number">15.9</span> Localized MDS</h2>
</section>
<section id="mds-as-mva" class="level2" data-number="15.10">
<h2 data-number="15.10" class="anchored" data-anchor-id="mds-as-mva"><span class="header-section-number">15.10</span> MDS as MVA</h2>
<p>Q methodology</p>
<p>http://qmethod.org</p>
<p><span class="citation" data-cites="stephenson_53">Stephenson (<a href="references.html#ref-stephenson_53" role="doc-biblioref">1953</a>)</span></p>
<p><span class="citation" data-cites="deleeuw_meulman_C_86">De Leeuw and Meulman (<a href="references.html#ref-deleeuw_meulman_C_86" role="doc-biblioref">1986</a>)</span> <span class="citation" data-cites="meulman_86">Meulman (<a href="references.html#ref-meulman_86" role="doc-biblioref">1986</a>)</span> <span class="citation" data-cites="meulman_92">Meulman (<a href="references.html#ref-meulman_92" role="doc-biblioref">1992</a>)</span></p>
</section>
<section id="conshorseshoes" class="level2" data-number="15.11">
<h2 data-number="15.11" class="anchored" data-anchor-id="conshorseshoes"><span class="header-section-number">15.11</span> Horseshoes</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-borg_lingoes_80" class="csl-entry" role="listitem">
Borg, I., and J. C. Lingoes. 1980. <span>“<span class="nocase">A Model and Algorithm for Multidimensional Scaling with External Constraints on the Distances</span>.”</span> <em>Psychometrika</em> 45 (1): 25–38.
</div>
<div id="ref-cox_cox_91" class="csl-entry" role="listitem">
Cox, T. F., and M. A. A. Cox. 1991. <span>“<span class="nocase">Multidimensional Scaling on a Sphere</span>.”</span> <em>Communications in Statistics</em> 20: 2943–53.
</div>
<div id="ref-cox_cox_01" class="csl-entry" role="listitem">
———. 2001. <em>Multidimensional Scaling</em>. Second Edition. Monographs on Statistics and Applied Probability 88. Chapman &amp; Hall.
</div>
<div id="ref-degruijter_67" class="csl-entry" role="listitem">
De Gruijter, D. N. M. 1967. <span>“<span class="nocase">The Cognitive Structure of Dutch Political Parties in 1966</span>.”</span> Report E019-67. Psychological Institute, University of Leiden.
</div>
<div id="ref-deleeuw_U_05j" class="csl-entry" role="listitem">
De Leeuw, J. 2005. <span>“<span class="nocase">Fitting Ellipsoids by Least Squares</span>.”</span> UCLA Department of Statistics. 2005. <a href="https://jansweb.netlify.app/publication/deleeuw-u-05-j/deleeuw-u-05-j.pdf">https://jansweb.netlify.app/publication/deleeuw-u-05-j/deleeuw-u-05-j.pdf</a>.
</div>
<div id="ref-deleeuw_R_07a" class="csl-entry" role="listitem">
———. 2007a. <span>“<span class="nocase">A Horseshoe for Multidimensional Scaling</span>.”</span> Preprint Series 530. Los Angeles, CA: UCLA Department of Statistics.
</div>
<div id="ref-deleeuw_U_07h" class="csl-entry" role="listitem">
———. 2007b. <span>“<span>Quadratic Surface Embedding</span>.”</span> UCLA Department of Statistics. 2007. <a href="https://jansweb.netlify.app/publication/deleeuw-u-07-h/deleeuw-u-07-h.pdf">https://jansweb.netlify.app/publication/deleeuw-u-07-h/deleeuw-u-07-h.pdf</a>.
</div>
<div id="ref-deleeuw_E_17d" class="csl-entry" role="listitem">
———. 2017a. <span>“<span class="nocase">Multidimensional Scaling with Distance Bounds</span>.”</span> 2017.
</div>
<div id="ref-deleeuw_E_17c" class="csl-entry" role="listitem">
———. 2017b. <span>“<span class="nocase">Multidimensional Scaling with Lower Bounds</span>.”</span> 2017.
</div>
<div id="ref-deleeuw_E_17b" class="csl-entry" role="listitem">
———. 2017c. <span>“<span class="nocase">Multidimensional Scaling with Upper Bounds</span>.”</span> 2017.
</div>
<div id="ref-deleeuw_heiser_C_80" class="csl-entry" role="listitem">
De Leeuw, J., and W. J. Heiser. 1980. <span>“Multidimensional Scaling with Restrictions on the Configuration.”</span> In <em>Multivariate Analysis, Volume <span>V</span></em>, edited by P. R. Krishnaiah, 501–22. Amsterdam, The Netherlands: North Holland Publishing Company.
</div>
<div id="ref-deleeuw_mair_A_09c" class="csl-entry" role="listitem">
De Leeuw, J., and P. Mair. 2009. <span>“<span class="nocase">Multidimensional Scaling Using Majorization: SMACOF in R</span>.”</span> <em>Journal of Statistical Software</em> 31 (3): 1–30. <a href="https://www.jstatsoft.org/article/view/v031i03">https://www.jstatsoft.org/article/view/v031i03</a>.
</div>
<div id="ref-deleeuw_meulman_C_86" class="csl-entry" role="listitem">
De Leeuw, J., and J. J. Meulman. 1986. <span>“Principal Component Analysis and Restricted Multidimensional Scaling.”</span> In <em>Classification as a Tool of Research</em>, edited by W. Gaul and M. Schader, 83–96. Amsterdam, London, New York, Tokyo: North-Holland.
</div>
<div id="ref-dinkelbach_67" class="csl-entry" role="listitem">
Dinkelbach, W. 1967. <span>“<span>On Nonlinear Fractional Programming</span>.”</span> <em>Management Science</em> 13: 492–98.
</div>
<div id="ref-groenen_giaquinto_kiers_03" class="csl-entry" role="listitem">
Groenen, P. J. F., P. Giaquinto, and H. A. L Kiers. 2003. <span>“<span class="nocase">Weighted Majorization Algorithms for Weighted Least Squares Decomposition Models</span>.”</span> Econometric Institute Report EI 2003-09. Econometric Institute, Erasmus University Rotterdam. <a href="https://repub.eur.nl/pub/1700">https://repub.eur.nl/pub/1700</a>.
</div>
<div id="ref-levelt_vandegeer_plomp_66" class="csl-entry" role="listitem">
Levelt, W. J. M., J. P. Van De Geer, and R. Plomp. 1966. <span>“<span class="nocase">Triadic Comparions of Musical Intervals</span>.”</span> <em>British Journal of Mathematical and Statistical Psychology</em> 19: 163–79.
</div>
<div id="ref-meulman_86" class="csl-entry" role="listitem">
Meulman, J. J. 1986. <span>“<span class="nocase">A Distance Approach to Nonlinear Multivariate Analysis</span>.”</span> PhD thesis, Leiden University.
</div>
<div id="ref-meulman_92" class="csl-entry" role="listitem">
———. 1992. <span>“<span class="nocase">The Integration of Multidimensional Scaling and Multivariate Analysis with Optimal Transformations</span>.”</span> <em>Psychometrika</em> 57 (4): 539–65.
</div>
<div id="ref-papazoglou_mylonas_17" class="csl-entry" role="listitem">
Papazoglou, S., and K. Mylonas. 2017. <span>“<span class="nocase">An Examination of Alternative Multidimensional Scaling Techniques</span>.”</span> <em>Educational and Psychological Measurement</em> 77 (3): 429–48.
</div>
<div id="ref-stephenson_53" class="csl-entry" role="listitem">
Stephenson, W. 1953. <em><span class="nocase">The Study of Behavior: Q-technique and its Methodology</span></em>. University of Chicago Press.
</div>
<div id="ref-vandegeer_levelt_plomp_62" class="csl-entry" role="listitem">
Van de Geer, J. P., W. J. M. Levelt, and R. Plomp. 1962. <span>“<span class="nocase">The Connotation of Musical Consonance</span>.”</span> <em>Acta Psychologica</em> 20: 308–19.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./unfolding.html" class="pagination-link" aria-label="Unfolding">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Unfolding</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./individual.html" class="pagination-link" aria-label="Individual Differences">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Individual Differences</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>