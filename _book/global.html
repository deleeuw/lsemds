<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>26&nbsp; In Search of Global Minima – Least Squares Euclidean Multidimensional Scaling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./software.html" rel="next">
<link href="./stability.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head><body class="nav-sidebar floating">.greybox {
  padding: 1em;
  background: white;
  color: black;
  border: 2px solid orange;
  border-radius: 10px;
}
.center {
  text-align: center;
}

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>





<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./global.html"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">In Search of Global Minima</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Least Squares Euclidean Multidimensional Scaling</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Note</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notation and Reserved Symbols</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./properties.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Properties of Stress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stress Spaces</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./minimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Minimization of Basic Stress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acceleration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Acceleration of Convergence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonmetric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Nonmetric MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Interval MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./polynomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Polynomial MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ordinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Ordinal MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./splinical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Splinical MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unidimensional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Unidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./full.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Full-dimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unfolding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Unfolding</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./constrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Constrained Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./individual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Individual Differences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./asymmetry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Asymmetry in MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nominal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Nominal MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonordinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Nonmonotonic MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonpairs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Compound Objects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sstress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">sstress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rstress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">fstress and rstress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./altls.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Alternative Least Squares Loss</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Inverse Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Stability of MDS Solutions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./global.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">In Search of Global Minima</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Software</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./backmatter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(APPENDIX) Appendices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#random-starts" id="toc-random-starts" class="nav-link active" data-scroll-target="#random-starts"><span class="header-section-number">26.1</span> Random Starts</a>
  <ul class="collapse">
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="header-section-number">26.1.1</span> Examples</a></li>
  </ul></li>
  <li><a href="#tunneling-filling-annealing-etc." id="toc-tunneling-filling-annealing-etc." class="nav-link" data-scroll-target="#tunneling-filling-annealing-etc."><span class="header-section-number">26.2</span> Tunneling, Filling, Annealing, etc.</a></li>
  <li><a href="#globcutplanes" id="toc-globcutplanes" class="nav-link" data-scroll-target="#globcutplanes"><span class="header-section-number">26.3</span> Cutting Planes</a>
  <ul class="collapse">
  <li><a href="#globalcircle" id="toc-globalcircle" class="nav-link" data-scroll-target="#globalcircle"><span class="header-section-number">26.3.1</span> On the Circle</a></li>
  <li><a href="#cauchy-step-size" id="toc-cauchy-step-size" class="nav-link" data-scroll-target="#cauchy-step-size"><span class="header-section-number">26.3.2</span> Cauchy Step Size</a></li>
  <li><a href="#balls" id="toc-balls" class="nav-link" data-scroll-target="#balls"><span class="header-section-number">26.3.3</span> Balls</a></li>
  </ul></li>
  <li><a href="#distance-smoothing" id="toc-distance-smoothing" class="nav-link" data-scroll-target="#distance-smoothing"><span class="header-section-number">26.4</span> Distance Smoothing</a></li>
  <li><a href="#penalizing-dimensions" id="toc-penalizing-dimensions" class="nav-link" data-scroll-target="#penalizing-dimensions"><span class="header-section-number">26.5</span> Penalizing Dimensions</a>
  <ul class="collapse">
  <li><a href="#local-minima" id="toc-local-minima" class="nav-link" data-scroll-target="#local-minima"><span class="header-section-number">26.5.1</span> Local Minima</a></li>
  <li><a href="#algorithm" id="toc-algorithm" class="nav-link" data-scroll-target="#algorithm"><span class="header-section-number">26.5.2</span> Algorithm</a></li>
  <li><a href="#examples-1" id="toc-examples-1" class="nav-link" data-scroll-target="#examples-1"><span class="header-section-number">26.5.3</span> Examples</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="global" class="quarto-section-identifier"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">In Search of Global Minima</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>We have already discussed the problem of finding the global minimum, instead of merely one or more local minima, in chapters @ref(fullchapter) and @ref(unidimensional). In the uni-dimensional case the basic MDS problem becomes combinatorial, we have to minimize over all <span class="math inline">\(n!\)</span> permutations of <span class="math inline">\(\iota_n\)</span>, and there usually are very many local minima, all of them strict. The case in which all <span class="math inline">\(\delta_{ij}\)</span> are the same shows there can be <span class="math inline">\(n!\)</span> local minima, all global. All these minima are strict and isolated, and thus a small perturbation of the equal-dissimilarity case still has <span class="math inline">\(n!\)</span> local minima (<span class="citation" data-cites="pliner_96">Pliner (<a href="references.html#ref-pliner_96" role="doc-biblioref">1996</a>)</span>). In the full-dimensional case there is only one minimum, which is by definition the global minimum. For <span class="math inline">\(1&lt;p&lt;n-1\)</span> we can expect to be somewhere between these two extremes, with in addition the possibility that some of the critical points are saddle points and not local minima. But note that if all dissimilarities are equal all permutations of the points in the global minimum configuration also give global minima, which means that even in higher dimensional cases we may have <span class="math inline">\(n!\)</span> local minima.</p>
<p>One way to protect against non-global minima is to start with a really good initial configuration. Generally, the Torgerson and Guttman initial configurations are helpful, and so are the first <span class="math inline">\(p\)</span> principal components of the full-dimensional solution. Another important tool is to stop iterations using the size of the gradient (or the difference between <span class="math inline">\(X\)</span> and <span class="math inline">\(\gamma(X)\)</span>), with a cut-off value of at least <span class="math inline">\(1e-7\)</span>, but preferably <span class="math inline">\(1e-10\)</span> or even <span class="math inline">\(1e-15\)</span>. Earlier implementations of smacof may have stopped too soon if the target local minimum is in a flat region of the configuration space, or if the iterations stray too close to a saddle point and must flex their muscle to get away from it.</p>
<p>In this chapter we will discuss some methods to find the global minimum, or, more modestly, to move from one local minimum to another better local minimum. The global optimization battlefield is in constant flux. New methods for general of specific global optimization problems seem to be invented every day, all struggling with the curse of dimensionality. The field is riddled with the remains of methods that died in infancy. So I am not saying I will discuss the best, or even the most promising, global optimization methods for MDS. I simply choose the ones I like best, and the ones that fit nicely into the smacof framework.</p>
<section id="random-starts" class="level2" data-number="26.1">
<h2 data-number="26.1" class="anchored" data-anchor-id="random-starts"><span class="header-section-number">26.1</span> Random Starts</h2>
<p>The simplest way to get an idea about the local minima of stress in any specific example is to run smacof with multiple random initial configurations. The implementation is simple. Put the smacof runs in a loop from 1 to <span class="math inline">\(N\)</span>, start each run with a random initial configuration, and collect the results in some data structure. It is true that our analysis will take <span class="math inline">\(N\)</span> times as long to finish, but just start up your PC and go and do something else while it runs. It seems to me that this ought to be standard practice for actual MDS applications. Not only do we find the best local minimum in terms of stress, but we get valuable information about the stability of our result. If we take, for example, <span class="math inline">\(N=1000\)</span> and we find the same local minimum in all runs, we can be reasonably confident that we have found the global minimum. A small change in the dissimilarities will probably find the same global minimum. If we find multiple local minima, all with about the same frequency and with stress values that are close, then a small change may very well switch to another local minimum with the smallest stress value.</p>
<p>There is some freedom in the choice of method to generate random initial configurations. In the examples in this chapter we sample from the standard multivariate normal, but since we know that at local minima <span class="math inline">\(\eta(X)\leq 1\)</span> it may be more appropriate to sample from the unit ball in <span class="math inline">\(\mathbb{R}^{n\times p}\)</span> (<span class="citation" data-cites="harman_lacko_10">Harman and Lacko (<a href="references.html#ref-harman_lacko_10" role="doc-biblioref">2010</a>)</span>). In fact, since we also know that at a local minimum <span class="math inline">\(\rho(X)=\eta^2(X)\)</span>, we may project our intial configurations on that surface.</p>
<p>metric - nonmetric</p>
<section id="examples" class="level3" data-number="26.1.1">
<h3 data-number="26.1.1" class="anchored" data-anchor-id="examples"><span class="header-section-number">26.1.1</span> Examples</h3>
<section id="ekman" class="level4" data-number="26.1.1.1">
<h4 data-number="26.1.1.1" class="anchored" data-anchor-id="ekman"><span class="header-section-number">26.1.1.1</span> Ekman</h4>
<p>We use the Ekman data to illustrate this. We use 1000 random starts, and we stop iterating when the decrease in stress is less than 1e-15. We find 8 local minima, listed in table @ref(tab:ekmanminima).</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Local Minima in Ekman Example</caption>
<thead>
<tr class="header">
<th style="text-align: right;">no</th>
<th style="text-align: right;">minimum</th>
<th style="text-align: right;">frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0086066</td>
<td style="text-align: right;">824</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0182714</td>
<td style="text-align: right;">136</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0300985</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.0309922</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.0317395</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.0331013</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0337281</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.0379281</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/ekmanhistplot1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Ekman Stress Values</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/ekmanhistplot2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Ekman Iteration Counts</figcaption>
</figure>
</div>
</div>
</div>
<p>The results are encouraging, because they indicate that, at least in the Ekman example, the lower the local minimum, the more attractive it is for the smacof iterations. The lowest local minima seem to have the largest regions of attraction. Specifically, we find what is presumably the global minimum in more than 80% of the cases. Nevertheless, if our clients were so unwise to start their MDS analysis with a random initial configuration then about 20% of them will get the wrong answer.</p>
<p>In the example we also see a number of local minima, found only in a small number of cases, whose stress values are very close to each other. It seems likely that others of roughly the same stress level will be found if we continue sampling additional random initial configurations.</p>
<p>The configurations corresponding with the two dominant local minima are in @ref(fig:ekmanlmplot1) and @ref(fig:ekmanlmplot2). if we compare them we see that the color circle has two separate circular segments. In the second local minimum the order of the colors on one of these two segments is reversed.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/ekmanlmplot1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Global (?) Minimum</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/ekmanlmplot2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Largest (?) Non-global Minimum</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="de-gruijter" class="level4" data-number="26.1.1.2">
<h4 data-number="26.1.1.2" class="anchored" data-anchor-id="de-gruijter"><span class="header-section-number">26.1.1.2</span> De Gruijter</h4>
<p>The Ekman example is somewhat atypical, because it has an exceptionally good fit. We perform the same computations for the De Gruijter example, still using a cut-off at 1e-15, but now allowing for up to 10,000 iterations.</p>
<p>The data in this example are averages of preference rankings for nine Dutch political parties by 100 students. Due to the heterogeneity of the population there is a considerable regression to the mean. Typically this would suggest splitting the students into more homogeneous groups (which is what <span class="citation" data-cites="degruijter_67">De Gruijter (<a href="references.html#ref-degruijter_67" role="doc-biblioref">1967</a>)</span> did), and/or using a form of non-metric scaling (which is what De Gruijter did as well).</p>
<p>Our 1000 runs produce 21 local minima, in table @ref{tab:gruijterlocalminima}, with stress values that are close to each other. In this case it is easy to imagine that more runs will produce many more local minima, with low frequencies, mainly permuting the political parties on the horseshoe. In other words, the situation is somewhat like the case in which all dissimilarities between the nine objects are equal, in which case we have $9!=$3.6288^{5} local minima, all with the same stress value.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Local Minima in De Gruijter Example</caption>
<thead>
<tr class="header">
<th style="text-align: right;">no</th>
<th style="text-align: right;">minimum</th>
<th style="text-align: right;">frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0222149</td>
<td style="text-align: right;">155</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0222262</td>
<td style="text-align: right;">85</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0222631</td>
<td style="text-align: right;">156</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.0223017</td>
<td style="text-align: right;">248</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.0232310</td>
<td style="text-align: right;">130</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.0244955</td>
<td style="text-align: right;">88</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.0245003</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.0246216</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.0254775</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.0254982</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.0261988</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.0273897</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.0274695</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.0297550</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.0303408</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: right;">0.0315674</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17</td>
<td style="text-align: right;">0.0315679</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">18</td>
<td style="text-align: right;">0.0356327</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.0362333</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: right;">0.0364538</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.0375689</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Another comparison may be useful. The Ekman example is like a matrix with two dominant eigenvalues, the De Gruijter example is like a matrix will all eigenvalues approximately equal to each other. Since smacof is somewhat like the power method, we expect poor convergence in the De Gruijter example, and histogram @ref(fig:histgruijter2) shows exactly that. There is even one random start from which there is no convergence in 10,000 iterations. In the Ekman example the frequency of the local minima seems closely related to the stress value at the local minimum, in the De Gruijter example the frequency of the local minims seems more random. In the Ekman case we can be pretty sure we have found the global minimum, in the De Gruijter case we are far from sure.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/histgruijter1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>De Gruijter Stress Values</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/histgruijter2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>De Gruijter Iteration Count</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> hgruijter[[<span class="dv">14</span>]]<span class="sc">$</span>x</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> hgruijter[[<span class="dv">1</span>]]<span class="sc">$</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/gruijterlmplot1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Largest Local Minimum</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/gruijterlmplot2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Another Local Minimum</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="tunneling-filling-annealing-etc." class="level2" data-number="26.2">
<h2 data-number="26.2" class="anchored" data-anchor-id="tunneling-filling-annealing-etc."><span class="header-section-number">26.2</span> Tunneling, Filling, Annealing, etc.</h2>
</section>
<section id="globcutplanes" class="level2" data-number="26.3">
<h2 data-number="26.3" class="anchored" data-anchor-id="globcutplanes"><span class="header-section-number">26.3</span> Cutting Planes</h2>
<p>In cutting plane methods we approximate a non-polyhedral compact convex set <span class="math inline">\(\mathcal{C}\)</span> by a sequence <span class="math inline">\(\mathcal{P}_n\)</span> of convex polyhedra. Approximation is from the outside, i.e.&nbsp;<span class="math inline">\(\mathcal{C}\subset\mathcal{P}_n\)</span>, strictly monotonic, i.e <span class="math inline">\(\mathcal{P}_{n+1}\subset\mathcal{P}_n\)</span>, and convergent, i.e.&nbsp;<span class="math inline">\(\lim_{n\rightarrow\infty}\mathcal{P_n}=\mathcal{C}\)</span>. Under suitable conditions the maximum/minimum <span class="math inline">\(f^\star_n\)</span> of a function <span class="math inline">\(f\)</span> on <span class="math inline">\(\mathcal{P}_n\)</span> will converge to <span class="math inline">\(f^\star\)</span>, the maximum/minimum of <span class="math inline">\(f\)</span> on <span class="math inline">\(\mathcal{C}\)</span>.</p>
<p>If we are maximizing a convex function on <span class="math inline">\(\mathcal{C}\)</span> then the maximum on the approximating polyhedron <span class="math inline">\(\mathcal{P}_n\)</span> will be at one of the vertices <span class="math inline">\(x^\star\)</span>. If <span class="math inline">\(x^\star\not\in\mathcal{C}\)</span> we cut it off by finding a hyperplane that separates <span class="math inline">\(x\)</span> and <span class="math inline">\(\mathcal{C}\)</span>. We can, for example, project <span class="math inline">\(x^\star\)</span> on <span class="math inline">\(\mathcal{C}\)</span> and use the tangent hyperplane to <span class="math inline">\(\mathcal{C}\)</span> in the projection <span class="math inline">\(\hat x\)</span>. Define <span class="math inline">\(\mathcal{P}_{n+1}\cap\{x\mid a'x\leq b\}\)</span>, with <span class="math inline">\(a'x=b\)</span> the separating hyperplane that has <span class="math inline">\(a'x\leq b\)</span> for each <span class="math inline">\(x\in\mathcal{C}\)</span> and <span class="math inline">\(a'x^\star &gt; b\)</span>.</p>
<p>The basic MDS problem can be reformulated as maximization of <span class="math inline">\(\rho(x)\)</span> on the unit ball <span class="math inline">\(\eta^2(x)=x'x\leq 1\)</span>. See sections @ref(propcoefspace) and @ref(propspherespace) for the reformulation tools. The cutting plane method in the case of a ball is particulary simple, at least conceptually. If <span class="math inline">\(x^\star\not\in\mathcal{C}\)</span> then its projection on the ball is <span class="math inline">\(\hat x=x^\star/\|x^\star\|\)</span> and the tangent hyperplane in <span class="math inline">\(\hat x\)</span> is <span class="math inline">\(\hat x'x\leq 1\)</span>.</p>
<p>Computationally, however, matters are not so simple. The polyhedron <span class="math inline">\(\mathcal{P}_n\)</span> is described by an increasing number of linear inequalities. Finding all vertices requires a non-trivial effort, and in the general case the method seems practical only for small or moderately small examples. In an actual implementation we would have to have a scheme for dropping or not adding redundant inequalities (that are implied by earlier inequalities) and a scheme for dropping inequalities generating vertices that can never be the global maximum. Such strategfies will depend on the nature of the function <span class="math inline">\(f\)</span> and on the convex set <span class="math inline">\(\mathcal{S}\)</span>.</p>
<section id="globalcircle" class="level3" data-number="26.3.1">
<h3 data-number="26.3.1" class="anchored" data-anchor-id="globalcircle"><span class="header-section-number">26.3.1</span> On the Circle</h3>
<p>For the circle the cutting plane method can be made very simple. Suppose we start with a <span class="math inline">\(n\)</span> distinct inner points <span class="math inline">\(x_1,\cdots,x_n\)</span> on the unit circle <span class="math inline">\(\mathcal{S}\)</span>, ordered clockwise so that <span class="math inline">\(x_1\)</span> is at the top of the circle (high noon). Let <span class="math inline">\(\mathcal{Q}_n\)</span> be their convex hull. Then <span class="math inline">\(\mathcal{Q}_n\subset\mathcal{S}\)</span>. The tangent lines at <span class="math inline">\(x_i\)</span> and <span class="math inline">\(x_{i+1}\)</span> intersect outside the circle in an outer point <span class="math inline">\(y_i\)</span>, with <span class="math inline">\(y_n\)</span> the intersection of the tangents at <span class="math inline">\(x_n\)</span> and <span class="math inline">\(x_1\)</span>. Let <span class="math inline">\(\mathcal{P}_n\)</span> be the convex hull of the <span class="math inline">\(y_i\)</span>. Then <span class="math inline">\(\mathcal{Q}_n\subset\mathcal{S}\subset\mathcal{P}_n\)</span> and thus <span class="math display">\[
\max_{i=1}^n\rho(x_i)=\max_{x\in\mathcal{Q}_n}\rho(x)\leq\max_{x\in\mathcal{S}}\rho(x)\leq\max_{x\in\mathcal{P}_n}\rho(x)=\max_{i=1}^n\rho(y_i).
\]</span> Thus we have easily computable lower and upper bounds for the global maximum of <span class="math inline">\(\rho\)</span> on <span class="math inline">\(\mathcal{S}\)</span>. The next step is to add the <span class="math inline">\(n\)</span> projections <span class="math inline">\(y_i/\|y_i\|\)</span> to the <span class="math inline">\(n\)</span> inner points to have a new set of <span class="math inline">\(2n\)</span> inner points. Then compute the corresponding <span class="math inline">\(2n\)</span> outer points, and so on. After <span class="math inline">\(k\)</span> steps we have <span class="math inline">\(2^kk_0\)</span> inner and outer points, where <span class="math inline">\(k_0\)</span> is the number of inner points we started with.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/circseg-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Circle Segment</figcaption>
</figure>
</div>
</div>
</div>
<p>As figure @ref(fig:circseg) shows, the outer point corresponding with two consecutive points on the circle lies on the perpendicular bisector of the line connecting the points. Using non-consecutive points will produce tangent lines which intersect farther away from the circle, and which consequently leads to a larger convex hull, and a worse approximation.</p>
<p>The next three figures illustrate the first iterations of the algorithm. We always start with <span class="math inline">\(n\)</span> inner points equally distributed on the unit circle, in this case <span class="math inline">\(n=4\)</span>. The circle is in red, the convex hulls of the outer and inner points are in blue.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/globalcircleplotfirst-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Starting Point</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/globalcircleplotsecond-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>After First Iteration</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/globalcircleplotthird-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>After Second Iteration</figcaption>
</figure>
</div>
</div>
</div>
<p>We see rapid convergence of the convex hulls to the circle. The figures also suggest an improvement of the method. Suppose <span class="math inline">\(\rho_0\)</span> is a lower bound of the global minimum <span class="math inline">\(\rho_\star\)</span> equal to the largest <span class="math inline">\(\rho\)</span> value of the inner points. Suppose an outer point has a <span class="math inline">\(\rho\)</span> value less than or equal to <span class="math inline">\(\rho_0\)</span>, consider the triangle with the outer point and the two inner points. All three vertices have a <span class="math inline">\(\rho\)</span> value less than or equal to <span class="math inline">\(\rho_0\)</span>, and because <span class="math inline">\(\rho\)</span> is convex so have all points in the triangle, including a segment of the circle. Thus we can <em>phantom</em> that segment of the circle and create no new inner points there. If <span class="math inline">\(\rho_0\)</span> get closer to <span class="math inline">\(\rho_\star\)</span> more and more segments of the circle are eliminated, which will presumably lead to faster computation. It seems advantageous to start with a value of <span class="math inline">\(\rho_0\)</span> that is as large as possible, for example by using the value the smacof algorithm converges to. We can then use the inner and outer points to check if the <span class="math inline">\(\rho\)</span> value is a global minimum.</p>
</section>
<section id="cauchy-step-size" class="level3" data-number="26.3.2">
<h3 data-number="26.3.2" class="anchored" data-anchor-id="cauchy-step-size"><span class="header-section-number">26.3.2</span> Cauchy Step Size</h3>
<p>The standard smacof update of <span class="math inline">\(X\)</span> (update method <span class="math inline">\(\text{up}_A\)</span> of section @ref(accelsimple)) is <span class="math inline">\(\gamma(X)=V^+B(X)X\)</span>. The relaxed update is <span class="math inline">\(X(\lambda):=\lambda \gamma(X)+(1-\lambda)X\)</span>. We usually choose <span class="math inline">\(\lambda=2\)</span>, which gives update method <span class="math inline">\(\text{up}_B\)</span> of section @ref(accelsimple).</p>
<p>The Cauchy or steepest descent update is <span class="math inline">\(X(\hat\lambda)\)</span>, with <span class="math display">\[\begin{equation}
\hat\lambda=\mathop{\text{argmin}}_{\lambda\geq 0}\sigma(X(\lambda)).
(\#eq:globlbdopt)
\end{equation}\]</span> There are some examples of the use of <span class="math inline">\(\hat\lambda\)</span> in <span class="citation" data-cites="deleeuw_heiser_C_80">De Leeuw and Heiser (<a href="references.html#ref-deleeuw_heiser_C_80" role="doc-biblioref">1980</a>)</span>, but there the optimal step-size is computed by using constrained smacof iterations, which may actually take us to just a local minimum along the line. In this example we use our circle methodology to compute the global minimum.</p>
<p>Now <span class="math inline">\(\text{tr}\ X'V\gamma(X)=\rho(X)\)</span> and thus if <span class="math inline">\(\text{tr}\ X'VX=1\)</span> then <span class="math inline">\(Y=\gamma(X)-\rho(X)X\)</span> satisfies <span class="math inline">\(\text{tr}\ X'VY=0\)</span> and <span class="math inline">\(\eta^2(Y)=\eta^2(\gamma(X))-\rho^2(X)\)</span>. Normalize <span class="math inline">\(Y\)</span> such that <span class="math inline">\(\text{tr}\ Y'VY=1\)</span>, and now maximize <span class="math inline">\(\rho\)</span> over <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, i.e.&nbsp;in configuration space maximize <span class="math inline">\(\rho(\alpha X+\beta Y)\)</span>, where <span class="math inline">\(\alpha^2+\beta^2=1\)</span>.</p>
<p>In the example we choose <span class="math inline">\(X\)</span> to be a <span class="math inline">\(10\times 2\)</span> matrix filled with random standard normals, and we start with 10 inner points on the circle. The iterations until convergence are as follows.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>itel       1 vertices      10 innermax       0.96683250 outermax       1.01451883 
itel       2 vertices      20 innermax       0.96683250 outermax       0.97744943 
itel       3 vertices      40 innermax       0.96683250 outermax       0.97008052 
itel       4 vertices      80 innermax       0.96709009 outermax       0.96794626 
itel       5 vertices     160 innermax       0.96720000 outermax       0.96739328 
itel       6 vertices     320 innermax       0.96720681 outermax       0.96726518 
itel       7 vertices     640 innermax       0.96721856 outermax       0.96722816 
itel       8 vertices    1280 innermax       0.96721856 outermax       0.96722140 
itel       9 vertices    2560 innermax       0.96721856 outermax       0.96721949 
itel      10 vertices    5120 innermax       0.96721876 outermax       0.96721890 
itel      11 vertices   10240 innermax       0.96721876 outermax       0.96721880 
itel      12 vertices   20480 innermax       0.96721876 outermax       0.96721877 
itel      13 vertices   40960 innermax       0.96721876 outermax       0.96721877 </code></pre>
</div>
</div>
<p>The optimal <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are 0.5464817, 0.837471. In configuration space this translates to -1.7919402$&nbsp;X+<span class="math inline">\(2.6770034\)</span>&nbsp;(X)$.</p>
</section>
<section id="balls" class="level3" data-number="26.3.3">
<h3 data-number="26.3.3" class="anchored" data-anchor-id="balls"><span class="header-section-number">26.3.3</span> Balls</h3>
<p>In dimension <span class="math inline">\(p&gt;2\)</span>, where <span class="math inline">\(\rho\)</span> must be maximized on the unit ball in <span class="math inline">\(\mathbb{R}^p\)</span>, matters are not so simple any more. There is no single compelling natural ordering of the points on the sphere or hypersphere, and thus we have to improvise more. We would like to maintain both upper and lower bounds for the global minimum that both keep improving in every iteration.</p>
<section id="outer-approximation" class="level4" data-number="26.3.3.1">
<h4 data-number="26.3.3.1" class="anchored" data-anchor-id="outer-approximation"><span class="header-section-number">26.3.3.1</span> Outer Approximation</h4>
<p>Let’s first discuss a possible initial set of inner and outer points that are more or less regularly spaced inside or outside the unit sphere. For the inner points we can use the vertices of the cross-polytope (or the <span class="math inline">\(\ell_1\)</span>-ball), which is the set of all <span class="math inline">\(x\)</span> in <span class="math inline">\(\mathbb{R}^n\)</span> with <span class="math inline">\(\sum_{i=1}^n|x_i|\leq 1\)</span>. If <span class="math inline">\(|x_i|\leq 1\)</span> then <span class="math inline">\(x_i^2\leq|x_i|\)</span> with equality iff <span class="math inline">\(x_i\in\{-1,0,1\}\)</span>. Thus <span class="math inline">\(x'x\leq\sum_{i=1}^n|x_i|\)</span> and <span class="math inline">\(x'x=\sum_{i=1}^n|x_i|=1\)</span> iff exactly one of <span class="math inline">\(x_i\)</span> is <span class="math inline">\(\pm 1\)</span>, i.e.&nbsp;there are <span class="math inline">\(2n\)</span> inner points on the sphere.</p>
<p>For the outer points we choose the vertices of <span class="math inline">\(\max_{i=1}^n|x_i|\leq 1\)</span>, or equivalently <span class="math inline">\(-1\leq x_i\leq +1\)</span> for all <span class="math inline">\(i\)</span>. Thus there are <span class="math inline">\(2^n\)</span> vertices which have <span class="math inline">\(x_i=\pm 1\)</span> for all <span class="math inline">\(i\)</span>.</p>
</section>
</section>
</section>
<section id="distance-smoothing" class="level2" data-number="26.4">
<h2 data-number="26.4" class="anchored" data-anchor-id="distance-smoothing"><span class="header-section-number">26.4</span> Distance Smoothing</h2>
<p><span class="math display">\[
d_{ij}(X,\epsilon):=\sqrt{d_{ij}^2(X)+\epsilon^2}
\]</span> <span class="math display">\[
d_{ij}^\epsilon(X):=\sqrt{d_{ij}^2(X)+\epsilon^2}
\]</span> <span class="math display">\[
\mathcal{D}d_{ij}^\epsilon(X)=\frac{1}{d_{ij}^\epsilon(X)}A_{ij}X
\]</span> <span class="math display">\[
\nabla\sigma_\epsilon(X)=2(V-B_\epsilon(X))X
\]</span></p>
<p><span class="math display">\[
\mathcal{D}^2\sigma_\epsilon(X)=
\]</span></p>
<div class="cell">
<pre class="theorem cell-code"><code>If $\epsilon\geq\max_{i,j}\delta_{ij}$ then $B(X_\epsilon)\lesssim V$ and thus $\mathcal{D}^2(X_\epsilon)\gtrsim 0$ for all $X$ and  $\sigma_\epsilon$ is convex.</code></pre>
</div>
<p><span class="math display">\[
\mathcal{D}_1d_{ij}(X,\epsilon)=\frac{1}{d_{ij}(X,\epsilon)}A_{ij}X
\]</span></p>
<p><span class="math display">\[
\nabla\sigma_\epsilon(X)=2\left(V-\mathop{\sum\sum}_{1\leq i&lt;j\leq n}w_{ij}\frac{\delta_{ij}}{d_{ij}(X_\epsilon)}A_{ij}\right)X
\]</span> <span class="math display">\[
\nabla^2\sigma_\epsilon(X)=2V-\mathop{\sum\sum}_{1\leq i&lt;j\leq n}w_{ij}\frac{\delta_{ij}}{d_{ij}(X_\epsilon)}A_{ij}X
\]</span></p>
</section>
<section id="penalizing-dimensions" class="level2" data-number="26.5">
<h2 data-number="26.5" class="anchored" data-anchor-id="penalizing-dimensions"><span class="header-section-number">26.5</span> Penalizing Dimensions</h2>
<p>In <span class="citation" data-cites="shepard_62a">Shepard (<a href="references.html#ref-shepard_62a" role="doc-biblioref">1962a</a>)</span> and <span class="citation" data-cites="shepard_62b">Shepard (<a href="references.html#ref-shepard_62b" role="doc-biblioref">1962b</a>)</span> an NMDS technique is developed that minimizes a loss function over configurations in full dimensionality <span class="math inline">\(n-1\)</span>. In that sense the technique is similar to FDS. Shepard’s iterative process, however, aims to maintain monotonicity between distances and dissimilarities and at the same time concentrate as much of the variation as possible in a small number of dimensions (<span class="citation" data-cites="deleeuw_E_17e">De Leeuw (<a href="references.html#ref-deleeuw_E_17e" role="doc-biblioref">2017</a>)</span>).</p>
<p>Let us explore the idea of concentrating variation in <span class="math inline">\(p&lt;n-1\)</span> dimensions, but use an approach which is quite different from the one used by Shepard. We remain in the FDS framework, but we aim for solutions in <span class="math inline">\(p&lt;n-1\)</span> dimensions by penalizing <span class="math inline">\(n-p\)</span> dimensions of the full configuration, using the classical Courant quadratic penalty function.</p>
<p>Partition a full configuration <span class="math inline">\(Z=\begin{bmatrix}X&amp;\mid&amp;Y\end{bmatrix}\)</span>, with <span class="math inline">\(X\)</span> of dimension <span class="math inline">\(n\times p\)</span> and <span class="math inline">\(Y\)</span> of dimension <span class="math inline">\(n\times(n-p)\)</span>. Then <span class="math display">\[\begin{equation}\label{E:part}   
\sigma(Z)=1-\mathbf{tr}\ X'B(Z)X - \mathbf{tr}\ Y'B(Z)Y+\frac12 \mathbf{tr}\ X'VX+\frac12 \mathbf{tr}\ Y'VY.
\end{equation}\]</span> Also define the <em>penalty term</em> <span class="math display">\[\begin{equation}\label{E:tau}
\tau(Y)=\frac12\mathbf{tr}\ Y'VY,
\end{equation}\]</span> and <em>penalized stress</em> <span class="math display">\[\begin{equation}\label{E:pi}
\pi(Z,\lambda)=\sigma(Z)+\lambda\ \tau(Y).
\end{equation}\]</span></p>
<p>Our proposed method is to minimize penalized stress over <span class="math inline">\(Z\)</span> for a sequence of values <span class="math inline">\(0=\lambda_1&lt;\lambda_2&lt;\cdots\lambda_m\)</span>. For <span class="math inline">\(\lambda=0\)</span> this is simply the FDS problem, for which we know we can compute the global minimum. For fixed <span class="math inline">\(0&lt;\lambda&lt;+\infty\)</span> this is a Penalized FDS or PFDS problem. PFDS problems with increasing values of <span class="math inline">\(\lambda\)</span> generate a <em>trajectory</em> <span class="math inline">\(Z(\lambda)\)</span> in configuration space.</p>
<p>The general theory of exterior penalty functions, which we review in section XX of this paper, shows that increasing <span class="math inline">\(\lambda\)</span> leads to an increasing sequence of stress values <span class="math inline">\(\sigma\)</span> and a decreasing sequence of penalty terms <span class="math inline">\(\tau\)</span>. If <span class="math inline">\(\lambda\rightarrow+\infty\)</span> we approximate the global minimum of the FDS problem with <span class="math inline">\(Z\)</span> of the form <span class="math inline">\(Z=\begin{bmatrix}X&amp;\mid&amp;0\end{bmatrix}\)</span>, i.e.&nbsp;of the pMDS problem. This assumes we do actually compute the global minimum for each value of <span class="math inline">\(\lambda\)</span>, which we hope we can do because we start at the FDS global minimum, and we slowly increase <span class="math inline">\(\lambda\)</span>. There is also a local version of the exterior penalty result, which implies that <span class="math inline">\(\lambda\rightarrow\infty\)</span> takes us to a local minimum of pMDS, so there is always the possibility of taking the wrong trajectory to a local minimum of pMDS.</p>
<section id="local-minima" class="level3" data-number="26.5.1">
<h3 data-number="26.5.1" class="anchored" data-anchor-id="local-minima"><span class="header-section-number">26.5.1</span> Local Minima</h3>
<p>The stationary equations of the PFDS problem are solutions to the equations</p>
<p><span class="math display">\[\begin{align}
(V-B(Z))X&amp;=0,\\
((1+\lambda)V-B(Z))Y&amp;=0.
\end{align}\]</span></p>
<p>We can easily related stationary points and local minima of the FDS and PFDS problem.</p>
<div class="cell">
<pre class="theorem cell-code"><code>1: If $X$ is a stationary point of the pMDS problem then $Z=[X\mid 0]$ is a stationary point of the PFDS problem, no matter what $\lambda$ is. 

2: If $Z=[X\mid 0]$ is a local minimum of the PFDS problem then $X$ is a local minimum of pMDS and 
$(1+\lambda)V-B(X)\gtrsim 0$, or $\lambda\geq\|V^+B(X)\|_\infty-1$, with $\|\bullet\|_\infty$ the spectral radius (largest eigenvalue).</code></pre>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Part 1 follows by simple substitution in the stationary equations.</p>
<p>Part 2 follows from the expansion for <span class="math inline">\(Z=[X+\epsilon P\mid\epsilon Q]\)</span>. <span class="math display">\[\begin{multline}\label{E:expand2}
\pi(Z)=\pi(X)+\epsilon\ \text{tr}\ P'\mathcal{D}\sigma(X)\ +\\+\frac12\epsilon^2\ \mathcal{D}^2\sigma(X)(P,P)+\frac12\epsilon^2\ \text{tr}\ Q'((1+\lambda)V-B(X))Q+o(\epsilon^2).
\end{multline}\]</span> At a local minimum we must have <span class="math inline">\(\mathcal{D}\sigma(X)=0\)</span> and <span class="math inline">\(\mathcal{D}^2\sigma(X)(P,P)\gtrsim 0\)</span>, which are the necessary conditions for a local minimum of pMDS. We also must have <span class="math inline">\(((1+\lambda)V-B(X))\gtrsim 0\)</span>.</p>
</div>
<p>Note that the conditions in part 2 of theorem @ref(thm:globlocal) are also sufficient for PFDS to have a local minimum at <span class="math inline">\([X\mid 0]\)</span>, provided we eliminate translational and rotational indeterminacy by a suitable reparametrization, as in <span class="citation" data-cites="deleeuw_R_93c">De Leeuw (<a href="references.html#ref-deleeuw_R_93c" role="doc-biblioref">1993</a>)</span>.</p>
</section>
<section id="algorithm" class="level3" data-number="26.5.2">
<h3 data-number="26.5.2" class="anchored" data-anchor-id="algorithm"><span class="header-section-number">26.5.2</span> Algorithm</h3>
<p>The smacof algorithm for penalized stress is a small modification of the unpenalized FDS algorithm (ref). We start our iterations for <span class="math inline">\(\lambda_j\)</span> with the solution for <span class="math inline">\(\lambda_{j-1}\)</span> (the starting solution for <span class="math inline">\(\lambda_1=0\)</span> can be completely arbitrary). The update rules for fixed <span class="math inline">\(\lambda\)</span> are</p>
<p><span class="math display">\[\begin{align}
X^{(k+1)}&amp;=V^+B(Z^{(k)})X^{(k)},\\
Y^{(k+1)}&amp;=\frac{1}{1+\lambda}V^+B(Z^{(k)})Y^{(k)}.
\end{align}\]</span></p>
<p>Thus we compute the FDS update <span class="math inline">\(Z^{(k+1)}=V^+B(Z^{(k)})Z^{(k)}\)</span> and then divide the last <span class="math inline">\(n-p\)</span> columns by <span class="math inline">\(1+\lambda\)</span>.</p>
<p>Code is in the appendix. Let us analyze a number of examples.</p>
</section>
<section id="examples-1" class="level3" data-number="26.5.3">
<h3 data-number="26.5.3" class="anchored" data-anchor-id="examples-1"><span class="header-section-number">26.5.3</span> Examples</h3>
<p>This section has a number of two-dimensional and a number of one-dimensional examples. The one-dimensional examples are of interest, because of the documented large number of local minima of stress in the one-dimensional case, and the fact that for small and medium <span class="math inline">\(n\)</span> exact solutions are available (for example, <span class="citation" data-cites="deleeuw_C_05h">De Leeuw (<a href="references.html#ref-deleeuw_C_05h" role="doc-biblioref">2005</a>)</span>). By default we use <code>seq(0, 1, length = 101)</code> for <span class="math inline">\(\lambda\)</span> in most examples, but for some of them we dig a bit deeper and use longer sequences with smaller increments.</p>
<p>If for some value of <span class="math inline">\(\lambda\)</span> the penalty term drops below the small cutoff <span class="math inline">\(\gamma\)</span>, for example 10^{-10}, then there is not need to try larger values of <span class="math inline">\(\lambda\)</span>, because they will just repeat the same result. We hope that result is the global minimum of the 2MDS problem.</p>
<p>The output for each example is a table in which we give, the minimum value of stress, the value of the penalty term at the minimum, the value of <span class="math inline">\(\lambda\)</span>, and the number of iterations needed for convergence. Typically we print for the first three, the last three, and some regularly spaced intermediate values of <span class="math inline">\(\lambda\)</span>. Remember that the stress values increase with increasing <span class="math inline">\(\lambda\)</span>, and the penalty values decrease.</p>
<p>For two-dimensional examples we plot all two-dimensional configurations, after rotating to optimum match (using the function <code>matchMe()</code> from the appendix). We connect corresponding points for different values of <span class="math inline">\(\lambda\)</span>. Points corresponding to the highest value of <span class="math inline">\(\lambda\)</span> are labeled and have a different plot symbol. For one-dimensional examples we put <code>1:n</code> on the horizontal axes and plot the single dimension on the vertical axis, again connecting corresponding points. We label the points corresponding with the highest value of <span class="math inline">\(\lambda\)</span>, and draw horizontal lines through them to more clearly show their order on the dimension.</p>
<p>The appendix also has code for the function <code>checkUni()</code>, which we have used to check the solutions in the one dimensional case are indeed local minima. The function checks the necessary condition for a local minimum <span class="math inline">\(x=V^+u\)</span>, with <span class="math display">\[
u_i=\sum_{j=1}^nw_{ij}\delta_{ij}\ \mathbf{sign}\ (x_i-x_j).
\]</span> It should be emphasized that all examples are just meant to study convergence of penalized FDS. There is no interpretation of the MDS results</p>
<section id="chi-squares" class="level4" data-number="26.5.3.1">
<h4 data-number="26.5.3.1" class="anchored" data-anchor-id="chi-squares"><span class="header-section-number">26.5.3.1</span> Chi Squares</h4>
<p>In this example, of order 10, the <span class="math inline">\(\delta_{ij}\)</span> are independent draws from a chi-square distribution with two degrees of freedom. There is no structure in this example, everything is random.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel  198 lambda   0.000000 stress 0.175144 penalty 0.321138 
itel    5 lambda   0.010000 stress 0.175156 penalty 0.027580 
itel    3 lambda   0.020000 stress 0.175187 penalty 0.025895 
itel    1 lambda   0.100000 stress 0.175914 penalty 0.015172 
itel    1 lambda   0.200000 stress 0.177666 penalty 0.004941 
itel    4 lambda   0.300000 stress 0.178912 penalty 0.000088 
itel    6 lambda   0.310000 stress 0.178933 penalty 0.000020 
itel   20 lambda   0.320000 stress 0.178939 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/chi-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>10 Chi Squares</figcaption>
</figure>
</div>
</div>
</div>
<p>It seems that in this example the first two dimensions of FDS are already close to optimal for 2MDS. This is because the Gower rank of the dissimilarities is only three (or maybe four, the fourth singular value of the FDS solution <span class="math inline">\(Z\)</span> is very small).</p>
</section>
<section id="regular-simplex" class="level4" data-number="26.5.3.2">
<h4 data-number="26.5.3.2" class="anchored" data-anchor-id="regular-simplex"><span class="header-section-number">26.5.3.2</span> Regular Simplex</h4>
<p>The regular simplex has all dissimilarities equal to one. We use an example with <span class="math inline">\(n=10\)</span>, for which the global minimum (as far as we know) of pMDS with <span class="math inline">\(p=2\)</span> is a configuration with nine points equally spaced on a circle and one point in the center.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel    1 lambda   0.000000 stress 0.000000 penalty 0.400000 
itel    7 lambda   0.010000 stress 0.000103 penalty 0.375240 
itel    5 lambda   0.020000 stress 0.000427 penalty 0.360212 
itel    2 lambda   0.100000 stress 0.009438 penalty 0.255499 
itel    1 lambda   0.200000 stress 0.031826 penalty 0.152804 
itel    1 lambda   0.300000 stress 0.059136 penalty 0.079739 
itel    1 lambda   0.400000 stress 0.081607 penalty 0.038004 
itel    1 lambda   0.500000 stress 0.097400 penalty 0.015499 
itel    1 lambda   0.600000 stress 0.106700 penalty 0.004060 
itel    1 lambda   0.700000 stress 0.109679 penalty 0.000427 
itel    1 lambda   0.710000 stress 0.109756 penalty 0.000320 
itel   92 lambda   0.720000 stress 0.109880 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/simplex10a-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Next, we look at the regular simplex with <span class="math inline">\(n=4\)</span>, for which the global minimum has four points equally spaced on a circle (i.e.&nbsp;in the corners of a square). We use <code>seq(0, 1, length = 101)</code> for the <span class="math inline">\(\lambda\)</span> sequence.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel    1 lambda   0.000000 stress 0.000000 penalty 0.250000 
itel    2 lambda   0.010000 stress 0.000033 penalty 0.162166 
itel    2 lambda   0.020000 stress 0.000158 penalty 0.156683 
itel    2 lambda   0.100000 stress 0.004569 penalty 0.103311 
itel    1 lambda   0.200000 stress 0.016120 penalty 0.041571 
itel    1 lambda   0.300000 stress 0.026039 penalty 0.007635 
itel    1 lambda   0.330000 stress 0.027355 penalty 0.003658 
itel    5 lambda   0.340000 stress 0.028272 penalty 0.000944 
itel   36 lambda   0.350000 stress 0.028595 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/simplex4a-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The solution converges to an equilateral triangle with the fourth point in the centroid. This is a local minimum. What basically happens is that the first two dimensions of the FDS solution are too close to the local minimum. Or, what amounts to the same thing, the Gower rank is too large (it is <span class="math inline">\(n-1\)</span> for a regular simplex) , there is too much variation in the higher dimensions, and as a consequence the first two dimensions of FDS are a bad 2MDS solution. We try to repair this by refining the trajectory, using <code>seq(0, 1, 10001)</code>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel    1 lambda   0.000000 stress 0.000000 penalty 0.250000 
itel    2 lambda   0.000100 stress 0.000000 penalty 0.166621 
itel    2 lambda   0.000200 stress 0.000000 penalty 0.166563 
itel    1 lambda   0.202200 stress 0.028595 penalty 0.000001 
itel    1 lambda   0.202300 stress 0.028595 penalty 0.000001 
itel    1 lambda   0.202400 stress 0.028595 penalty 0.000001 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/simplex4b-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now the trajectories move us from what starts out similar to an equilateral triangle to the corners of the square, and thus we do find the global minimum in this way. It is remarkable that we manage to find the square even when we start closer to the triangle with midpoint.</p>
</section>
<section id="intelligence" class="level4" data-number="26.5.3.3">
<h4 data-number="26.5.3.3" class="anchored" data-anchor-id="intelligence"><span class="header-section-number">26.5.3.3</span> Intelligence</h4>
<p>These are correlations between eight intelligence tests, taken from the smacof package. We convert to dissimilarities by taking the negative logarithm of the correlations. As in the chi-square example, the FDS and the 2MDS solution are very similar and the PMDS trajectories are short.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel 2951 lambda   0.000000 stress 0.107184 penalty 7.988384 
itel    7 lambda   0.010000 stress 0.107560 penalty 0.685654 
itel    4 lambda   0.020000 stress 0.108528 penalty 0.628538 
itel    3 lambda   0.030000 stress 0.110045 penalty 0.573208 
itel    3 lambda   0.040000 stress 0.112449 penalty 0.510730 
itel    2 lambda   0.050000 stress 0.114714 penalty 0.464650 
itel    2 lambda   0.060000 stress 0.117623 penalty 0.415037 
itel    2 lambda   0.070000 stress 0.121095 penalty 0.364536 
itel    2 lambda   0.080000 stress 0.125010 penalty 0.315023 
itel    2 lambda   0.090000 stress 0.129226 penalty 0.267831 
itel    2 lambda   0.100000 stress 0.133589 penalty 0.223898 
itel    2 lambda   0.110000 stress 0.137944 penalty 0.183868 
itel    3 lambda   0.120000 stress 0.143921 penalty 0.133739 
itel    2 lambda   0.130000 stress 0.147473 penalty 0.106166 
itel    4 lambda   0.140000 stress 0.153215 penalty 0.064499 
itel    4 lambda   0.150000 stress 0.157159 penalty 0.037735 
itel    9 lambda   0.160000 stress 0.161434 penalty 0.010337 
itel   72 lambda   0.170000 stress 0.163122 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/intelligence-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The singular values of the FDS solution are 1.78e+00, 1.36e+00, 5.94e-01, 1.47e-01, 3.29e-03, 1.87e-16, 4.37e-17, 3.78e-18, which shows that the Gower rank is probably five, but approximately two.</p>
</section>
<section id="countries" class="level4" data-number="26.5.3.4">
<h4 data-number="26.5.3.4" class="anchored" data-anchor-id="countries"><span class="header-section-number">26.5.3.4</span> Countries</h4>
<p>This is the wish dataset from the smacof package, with similarities between 12 countries. They are converted to dissimilarties by subtracting each of them from seven.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel 1381 lambda   0.000000 stress 4.290534 penalty 98.617909 
itel    4 lambda   0.010000 stress 4.301341 penalty 36.137074 
itel    3 lambda   0.020000 stress 4.336243 penalty 34.389851 
itel    1 lambda   0.100000 stress 5.187917 penalty 23.300775 
itel    1 lambda   0.200000 stress 7.539228 penalty 11.543635 
itel    1 lambda   0.300000 stress 9.901995 penalty 4.963372 
itel    1 lambda   0.400000 stress 11.523357 penalty 1.859569 
itel    1 lambda   0.500000 stress 12.391692 penalty 0.556411 
itel    1 lambda   0.590000 stress 12.696493 penalty 0.080144 
itel    1 lambda   0.600000 stress 12.708627 penalty 0.060113 
itel  100 lambda   0.610000 stress 12.738355 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/countries-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The singular values of the FDS solution are 4.20e+00, 3.71e+00, 2.67e+00, 1.80e+00, 1.33e+00, 6.64e-01, 5.97e-04, 7.74e-16, 3.18e-16, 2.25e-16, 8.42e-17, 4.53e-18, and the Gower rank is six or seven.</p>
</section>
<section id="dutch-political-parties" class="level4" data-number="26.5.3.5">
<h4 data-number="26.5.3.5" class="anchored" data-anchor-id="dutch-political-parties"><span class="header-section-number">26.5.3.5</span> Dutch Political Parties</h4>
<p>In 1967 one hundred psychology students at Leiden University judged the similarity of nine Dutch political parties, using the complete method of triads (<span class="citation" data-cites="degruijter_67">De Gruijter (<a href="references.html#ref-degruijter_67" role="doc-biblioref">1967</a>)</span>). Data were aggregated and converted to dissimilarities. We first print the matrix of dissimilarities.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>     KVP    PvdA   VVD    ARP    CHU    CPN    PSP    BP     D66   
KVP  +0.000 +0.209 +0.196 +0.171 +0.179 +0.281 +0.250 +0.267 +0.230
PvdA +0.209 +0.000 +0.250 +0.210 +0.231 +0.190 +0.171 +0.269 +0.204
VVD  +0.196 +0.250 +0.000 +0.203 +0.185 +0.302 +0.281 +0.257 +0.174
ARP  +0.171 +0.210 +0.203 +0.000 +0.119 +0.292 +0.250 +0.271 +0.228
CHU  +0.179 +0.231 +0.185 +0.119 +0.000 +0.290 +0.263 +0.259 +0.225
CPN  +0.281 +0.190 +0.302 +0.292 +0.290 +0.000 +0.152 +0.236 +0.276
PSP  +0.250 +0.171 +0.281 +0.250 +0.263 +0.152 +0.000 +0.256 +0.237
BP   +0.267 +0.269 +0.257 +0.271 +0.259 +0.236 +0.256 +0.000 +0.274
D66  +0.230 +0.204 +0.174 +0.228 +0.225 +0.276 +0.237 +0.274 +0.000</code></pre>
</div>
</div>
<p>The trajectories from FDS to 2MDS show some clear movement, especially of the D’66 party, which was new at the time.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel  223 lambda   0.000000 stress 0.000000 penalty 0.414526 
itel    5 lambda   0.010000 stress 0.000061 penalty 0.196788 
itel    2 lambda   0.020000 stress 0.000199 penalty 0.190472 
itel    1 lambda   0.100000 stress 0.004399 penalty 0.136576 
itel    1 lambda   0.200000 stress 0.015811 penalty 0.075466 
itel    1 lambda   0.300000 stress 0.028235 penalty 0.036636 
itel    1 lambda   0.400000 stress 0.038275 penalty 0.012608 
itel    1 lambda   0.500000 stress 0.043644 penalty 0.002156 
itel    1 lambda   0.520000 stress 0.044091 penalty 0.001324 
itel    1 lambda   0.530000 stress 0.044253 penalty 0.001019 
itel  277 lambda   0.540000 stress 0.044603 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/poldist_run-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There seems to be some bifurcation going on at the end, so we repeat the analysis using <code>seq(0, 1, length = 1001)</code> for <span class="math inline">\(\lambda\)</span>. The results turn out to be basically the same.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel  223 lambda   0.000000 stress 0.000000 penalty 0.414526 
itel    4 lambda   0.001000 stress 0.000001 penalty 0.204225 
itel    2 lambda   0.002000 stress 0.000002 penalty 0.203535 
itel    1 lambda   0.468000 stress 0.044604 penalty 0.000001 
itel    1 lambda   0.469000 stress 0.044604 penalty 0.000000 
itel  166 lambda   0.470000 stress 0.044603 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/poldist2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The singular values of the FDS solution are 2.95e-01, 2.10e-01, 1.89e-01, 1.34e-01, 1.16e-01, 1.06e-01, 8.61e-02, 7.06e-02, 1.10e-17, and the Gower rank is probably eight. This is mainly because these data, being averages, regress to the mean and thus have a substantial additive constant. If we repeat the analysis after subtracting .1 from all dissimilarities we get basically the same solution, but with somewhat smoother trajectories.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel  511 lambda   0.000000 stress 0.000176 penalty 0.150789 
itel    2 lambda   0.001000 stress 0.000176 penalty 0.037759 
itel    2 lambda   0.002000 stress 0.000176 penalty 0.037619 
itel    1 lambda   0.370000 stress 0.007642 penalty 0.000000 
itel    1 lambda   0.371000 stress 0.007642 penalty 0.000000 
itel    1 lambda   0.372000 stress 0.007642 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/poldist3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now the singular values of the FDS solution are 2.05e-01, 1.34e-01, 1.11e-01, 6.03e-02, 3.11e-02, 3.97e-04, 1.18e-07, 4.55e-12, 1.16e-17, and the approximate Gower rank is more like five or six.</p>
</section>
<section id="ekman-1" class="level4" data-number="26.5.3.6">
<h4 data-number="26.5.3.6" class="anchored" data-anchor-id="ekman-1"><span class="header-section-number">26.5.3.6</span> Ekman</h4>
<p>The next example analyzes dissimilarities between 14 colors, taken from <span class="citation" data-cites="ekman_54">Ekman (<a href="references.html#ref-ekman_54" role="doc-biblioref">1954</a>)</span>. The original similarities <span class="math inline">\(s_{ij}\)</span>, averaged over 31 subjects, were transformed to dissimilarities by <span class="math inline">\(\delta_{ij}=1-s_{ij}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel 1482 lambda   0.000000 stress 0.000088 penalty 0.426110 
itel    5 lambda   0.010000 stress 0.000132 penalty 0.118988 
itel    3 lambda   0.020000 stress 0.000253 penalty 0.112777 
itel    1 lambda   0.100000 stress 0.003195 penalty 0.070791 
itel    1 lambda   0.200000 stress 0.010778 penalty 0.024407 
itel    1 lambda   0.300000 stress 0.016125 penalty 0.003230 
itel    1 lambda   0.400000 stress 0.017142 penalty 0.000165 
itel    4 lambda   0.500000 stress 0.017213 penalty 0.000000 
itel    1 lambda   0.600000 stress 0.017213 penalty 0.000000 
itel    1 lambda   0.610000 stress 0.017213 penalty 0.000000 
itel    1 lambda   0.620000 stress 0.017213 penalty 0.000000 
itel    1 lambda   0.630000 stress 0.017213 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/ekman_global-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If we transform the Ekman similarities by <span class="math inline">\(\delta_{ij}=(1-s_{ij})^3\)</span> then its is known (<span class="citation" data-cites="deleeuw_E_16k">De Leeuw (<a href="references.html#ref-deleeuw_E_16k" role="doc-biblioref">2016</a>)</span>) that the Gower rank is equal to two. Thus the FDS solution has rank 2, and the 2MDS solution is the global minimum.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel   99 lambda   0.000000 stress 0.011025 penalty 0.433456 
itel    1 lambda   0.010000 stress 0.011025 penalty 0.000000 
itel    1 lambda   0.020000 stress 0.011025 penalty 0.000000 
itel    1 lambda   0.100000 stress 0.011025 penalty 0.000000 
itel    1 lambda   0.110000 stress 0.011025 penalty 0.000000 
itel    1 lambda   0.120000 stress 0.011025 penalty 0.000000 
itel    1 lambda   0.130000 stress 0.011025 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/okman-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="morse-in-two" class="level4" data-number="26.5.3.7">
<h4 data-number="26.5.3.7" class="anchored" data-anchor-id="morse-in-two"><span class="header-section-number">26.5.3.7</span> Morse in Two</h4>
<p>Next, we use dissimilarities between 36 Morse code signals (<span class="citation" data-cites="rothkopf_57">Rothkopf (<a href="references.html#ref-rothkopf_57" role="doc-biblioref">1957</a>)</span>). We used the symmetrized version <code>morse</code> from the <code>smacof</code> package (<span class="citation" data-cites="deleeuw_mair_A_09c">De Leeuw and Mair (<a href="references.html#ref-deleeuw_mair_A_09c" role="doc-biblioref">2009</a>)</span>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel 1461 lambda   0.000000 stress 0.000763 penalty 0.472254 
itel    6 lambda   0.010000 stress 0.000858 penalty 0.322181 
itel    4 lambda   0.020000 stress 0.001147 penalty 0.308335 
itel    1 lambda   0.100000 stress 0.008576 penalty 0.216089 
itel    1 lambda   0.200000 stress 0.028903 penalty 0.119364 
itel    1 lambda   0.300000 stress 0.051285 penalty 0.060060 
itel    1 lambda   0.400000 stress 0.068653 penalty 0.028190 
itel    1 lambda   0.500000 stress 0.080258 penalty 0.011356 
itel    1 lambda   0.600000 stress 0.086572 penalty 0.003578 
itel    1 lambda   0.700000 stress 0.089140 penalty 0.000854 
itel    1 lambda   0.800000 stress 0.089898 penalty 0.000116 
itel    1 lambda   0.830000 stress 0.089958 penalty 0.000053 
itel    1 lambda   0.840000 stress 0.089970 penalty 0.000040 
itel  197 lambda   0.850000 stress 0.089949 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/morse-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="vegetables" class="level4" data-number="26.5.3.8">
<h4 data-number="26.5.3.8" class="anchored" data-anchor-id="vegetables"><span class="header-section-number">26.5.3.8</span> Vegetables</h4>
<p>Our first one-dimensional example uses paired comparisons of 9 vegetables, originating with <span class="citation" data-cites="guilford_54">Guilford (<a href="references.html#ref-guilford_54" role="doc-biblioref">1954</a>)</span>. The proportions are transformed to dissimilarities by using the absolute values of the normal quantile function, i.e.&nbsp;<span class="math inline">\(\delta_{ij}=|\Phi^{-1}(p_{ij})|\)</span>. We use a short sequence for <span class="math inline">\(\lambda\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel 1412 lambda   0.000000 stress 0.013675 penalty 0.269308 
itel    5 lambda   0.010000 stress 0.013716 penalty 0.114786 
itel    5 lambda   0.100000 stress 0.016719 penalty 0.069309 
itel   23 lambda   1.000000 stress 0.035301 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/veg-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This example was previously analyzed by me in <span class="citation" data-cites="deleeuw_C_05h">De Leeuw (<a href="references.html#ref-deleeuw_C_05h" role="doc-biblioref">2005</a>)</span> using enumeration of all permutations. I found 14354 isolated local minima, and a global minimum equal to the one we computed here.</p>
</section>
<section id="plato" class="level4" data-number="26.5.3.9">
<h4 data-number="26.5.3.9" class="anchored" data-anchor-id="plato"><span class="header-section-number">26.5.3.9</span> Plato</h4>
<p><span class="citation" data-cites="mair_groenen_deleeuw_A_19">(<a href="references.html#ref-mair_groenen_deleeuw_A_19" role="doc-biblioref"><strong>mair_groenen_deleeuw_A_19?</strong></a>)</span> use seriation of the works of Plato, from the data collected by <span class="citation" data-cites="cox_brandwood_59">Cox and Brandwood (<a href="references.html#ref-cox_brandwood_59" role="doc-biblioref">1959</a>)</span>, as an example of unidimensional scaling. We first run this example with our usual sequence of five <span class="math inline">\(\lambda\)</span> values.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel  169 lambda   0.000000 stress 0.000000 penalty 0.410927 
itel    3 lambda   0.010000 stress 0.000062 penalty 0.255246 
itel    3 lambda   0.100000 stress 0.005117 penalty 0.194993 
itel    4 lambda   1.000000 stress 0.106058 penalty 0.019675 
itel    9 lambda  10.000000 stress 0.139462 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/plato-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This gives the order</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]       
[1,] "Timaeus"  
[2,] "Republic" 
[3,] "Critias"  
[4,] "Sophist"  
[5,] "Politicus"
[6,] "Philebus" 
[7,] "Laws"     </code></pre>
</div>
</div>
<p>which is different from the order at the global minimum that has Republic before Timaeus. Thus we have recovered a local minimum, and it seems our sequence of <span class="math inline">\(\lambda\)</span> values was not fine enough to do the job properly. So we try a longer and finer sequence.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel  169 lambda   0.000000 stress 0.000000 penalty 0.410927 
itel    3 lambda   0.000100 stress 0.000000 penalty 0.263015 
itel    3 lambda   0.001000 stress 0.000001 penalty 0.262280 
itel    3 lambda   0.010000 stress 0.000064 penalty 0.255078 
itel    3 lambda   0.100000 stress 0.005123 penalty 0.194945 
itel    2 lambda   0.200000 stress 0.016184 penalty 0.147493 
itel    1 lambda   0.300000 stress 0.026997 penalty 0.119323 
itel    1 lambda   0.400000 stress 0.040023 penalty 0.093615 
itel    1 lambda   0.500000 stress 0.053688 penalty 0.072330 
itel    1 lambda   0.600000 stress 0.066833 penalty 0.055452 
itel    1 lambda   0.700000 stress 0.078832 penalty 0.042269 
itel    1 lambda   0.800000 stress 0.089439 penalty 0.032019 
itel    1 lambda   0.900000 stress 0.098557 penalty 0.024079 
itel    1 lambda   1.000000 stress 0.106135 penalty 0.017940 
itel    6 lambda   2.000000 stress 0.130789 penalty 0.000148 
itel   13 lambda   3.000000 stress 0.131135 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/plato2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now the order is</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]       
[1,] "Republic" 
[2,] "Timaeus"  
[3,] "Critias"  
[4,] "Sophist"  
[5,] "Politicus"
[6,] "Philebus" 
[7,] "Laws"     </code></pre>
</div>
</div>
<p>which does indeed correspond to the global minimum.</p>
<p>With a different <span class="math inline">\(\lambda\)</span> sequence we find the same solution.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>itel  169 lambda   0.000000 stress 0.000000 penalty 0.410927 
itel    3 lambda   0.001000 stress 0.000001 penalty 0.262296 
itel    2 lambda   0.002000 stress 0.000003 penalty 0.261483 
itel    2 lambda   0.004000 stress 0.000010 penalty 0.259872 
itel    2 lambda   0.008000 stress 0.000041 penalty 0.256690 
itel    2 lambda   0.016000 stress 0.000159 penalty 0.250470 
itel    2 lambda   0.032000 stress 0.000613 penalty 0.238574 
itel    2 lambda   0.064000 stress 0.002266 penalty 0.216785 
itel    2 lambda   0.128000 stress 0.007791 penalty 0.180067 
itel    2 lambda   0.256000 stress 0.023483 penalty 0.127006 
itel    2 lambda   0.512000 stress 0.056940 penalty 0.067948 
itel    3 lambda   1.024000 stress 0.107743 penalty 0.017937 
itel    8 lambda   2.048000 stress 0.131059 penalty 0.000032 
itel    9 lambda   4.096000 stress 0.131135 penalty 0.000000 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/plato3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The order is</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]       
[1,] "Republic" 
[2,] "Timaeus"  
[3,] "Critias"  
[4,] "Sophist"  
[5,] "Politicus"
[6,] "Philebus" 
[7,] "Laws"     </code></pre>
</div>
</div>
</section>
<section id="morse-in-one" class="level4" data-number="26.5.3.10">
<h4 data-number="26.5.3.10" class="anchored" data-anchor-id="morse-in-one"><span class="header-section-number">26.5.3.10</span> Morse in One</h4>
<p>Now for a more challenging example. The Morse code data have been used to try out exact unidimensional MDS techniques, for example by <span class="citation" data-cites="palubeckis_13">Palubeckis (<a href="references.html#ref-palubeckis_13" role="doc-biblioref">2013</a>)</span>. We will enter the global minimum contest by using 10,000 values of <span class="math inline">\(\lambda\)</span>, in an equally spaced sequence from 0 to 10. This is not as bad as it sounds. For the 10,000 FDS solutions <code>system.time()</code> tells us</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   user  system elapsed 
  4.901   0.233   5.139 </code></pre>
</div>
</div>
<p>The one-dimensional plot show quite a bit of movement, but much of it seems to be contained in the very first change of <span class="math inline">\(\lambda\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="graphics/morse.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>We can also plot stress and the penalty term as functions of <span class="math inline">\(\lambda\)</span>. Again, note the big change in the penalty term when <span class="math inline">\(\lambda\)</span> goes from zero to 0.001.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="global_files/figure-html/iter-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>After the first 2593 values of <span class="math inline">\(\lambda\)</span> the penalty term is zero and we stop, i.e.&nbsp;we estimate <span class="math inline">\(\lambda_+\)</span> is 2.593. At that point we have run a total of 5013 FDS iterations, and thus on average about two iterations per <span class="math inline">\(\lambda\)</span> value. Stress has increased from 0.0007634501 to 0.2303106976 and the penalty value has decreased from 0.4815136419 to 0.0000000001. We find the following order of the points on the dimension.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]   
 [1,] "."    
 [2,] "-"    
 [3,] ".."   
 [4,] ".-"   
 [5,] "-."   
 [6,] "--"   
 [7,] "..."  
 [8,] "..-"  
 [9,] ".-."  
[10,] ".--"  
[11,] "...." 
[12,] "-.."  
[13,] "-.-"  
[14,] "...-" 
[15,] "....."
[16,] "....-"
[17,] "..-." 
[18,] ".-.." 
[19,] "-..." 
[20,] "-..-" 
[21,] "-...."
[22,] "...--"
[23,] "-.-." 
[24,] "-.--" 
[25,] "--..."
[26,] "--.." 
[27,] "--.-" 
[28,] ".--." 
[29,] ".---" 
[30,] "--."  
[31,] "---"  
[32,] "..---"
[33,] "---.."
[34,] ".----"
[35,] "----."
[36,] "-----"</code></pre>
</div>
</div>
<p>Our order, and consequently our solution, is the same as the exact global solution given by <span class="citation" data-cites="palubeckis_13">Palubeckis (<a href="references.html#ref-palubeckis_13" role="doc-biblioref">2013</a>)</span>. See his table 4, reproduced below. The difference is that computing our solution takes 10 seconds, while his takes 494 seconds. But of course we would not have known we actually found the global mimimum if the exact exhaustive methods had not analyzed the same data as well.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-cox_brandwood_59" class="csl-entry" role="listitem">
Cox, D. R., and L. Brandwood. 1959. <span>“<span class="nocase">On a Discriminatory Problem Connected with the Works of Plato</span>.”</span> <em>Journal of the Royal Statistical Society, Series B</em> 21: 195–200.
</div>
<div id="ref-degruijter_67" class="csl-entry" role="listitem">
De Gruijter, D. N. M. 1967. <span>“<span class="nocase">The Cognitive Structure of Dutch Political Parties in 1966</span>.”</span> Report E019-67. Psychological Institute, University of Leiden.
</div>
<div id="ref-deleeuw_R_93c" class="csl-entry" role="listitem">
De Leeuw, J. 1993. <span>“Fitting Distances by Least Squares.”</span> Preprint Series 130. Los Angeles, CA: UCLA Department of Statistics. <a href="https://jansweb.netlify.app/publication/deleeuw-r-93-c/deleeuw-r-93-c.pdf">https://jansweb.netlify.app/publication/deleeuw-r-93-c/deleeuw-r-93-c.pdf</a>.
</div>
<div id="ref-deleeuw_C_05h" class="csl-entry" role="listitem">
———. 2005. <span>“<span>Unidimensional Scaling</span>.”</span> In <em>The Encyclopedia of Statistics in Behavioral Science</em>, edited by B. S. Everitt and D. Howell, 4:2095–97. New York, N.Y.: Wiley.
</div>
<div id="ref-deleeuw_E_16k" class="csl-entry" role="listitem">
———. 2016. <span>“Gower Rank.”</span> 2016. <a href="https://jansweb.netlify.app/publication/deleeuw-e-16-k/deleeuw-e-16-k.pdf">https://jansweb.netlify.app/publication/deleeuw-e-16-k/deleeuw-e-16-k.pdf</a>.
</div>
<div id="ref-deleeuw_E_17e" class="csl-entry" role="listitem">
———. 2017. <span>“<span class="nocase">Shepard Non-metric Multidimensional Scaling</span>.”</span> 2017. <a href="https://jansweb.netlify.app/publication/deleeuw-e-17-e/deleeuw-e-17-e.pdf">https://jansweb.netlify.app/publication/deleeuw-e-17-e/deleeuw-e-17-e.pdf</a>.
</div>
<div id="ref-deleeuw_heiser_C_80" class="csl-entry" role="listitem">
De Leeuw, J., and W. J. Heiser. 1980. <span>“Multidimensional Scaling with Restrictions on the Configuration.”</span> In <em>Multivariate Analysis, Volume <span>V</span></em>, edited by P. R. Krishnaiah, 501–22. Amsterdam, The Netherlands: North Holland Publishing Company.
</div>
<div id="ref-deleeuw_mair_A_09c" class="csl-entry" role="listitem">
De Leeuw, J., and P. Mair. 2009. <span>“<span class="nocase">Multidimensional Scaling Using Majorization: SMACOF in R</span>.”</span> <em>Journal of Statistical Software</em> 31 (3): 1–30. <a href="https://www.jstatsoft.org/article/view/v031i03">https://www.jstatsoft.org/article/view/v031i03</a>.
</div>
<div id="ref-ekman_54" class="csl-entry" role="listitem">
Ekman, G. 1954. <span>“<span class="nocase">Dimensions of Color Vision</span>.”</span> <em>Journal of Psychology</em> 38: 467–74.
</div>
<div id="ref-guilford_54" class="csl-entry" role="listitem">
Guilford, J. P. 1954. <em>Psychometric Methods</em>. McGraw-Hill.
</div>
<div id="ref-harman_lacko_10" class="csl-entry" role="listitem">
Harman, R., and V. Lacko. 2010. <span>“<span class="nocase">On Decompositional aAgorithms for Uniform Sampling from n-Spheres and n-Balls</span>.”</span> <em>Journal of Multivariate Analysis</em> 101: 2297–2304.
</div>
<div id="ref-palubeckis_13" class="csl-entry" role="listitem">
Palubeckis, G. 2013. <span>“<span class="nocase">An Improved Exact Algorithm for Least-Squares Unidimensional Scaling</span>.”</span> <em>Journal of Applied Mathematics</em>, 1–15.
</div>
<div id="ref-pliner_96" class="csl-entry" role="listitem">
Pliner, V. 1996. <span>“<span class="nocase">Metric Unidimensional Scaling and Global Optimization</span>.”</span> <em>Journal of Classification</em> 13: 3–18.
</div>
<div id="ref-rothkopf_57" class="csl-entry" role="listitem">
Rothkopf, E. Z. 1957. <span>“<span class="nocase">A Measure of Stimulus Similarity and Errors in some Paired-associate Learning</span>.”</span> <em>Journal of Experimental Psychology</em> 53: 94–101.
</div>
<div id="ref-shepard_62a" class="csl-entry" role="listitem">
Shepard, R. N. 1962a. <span>“<span class="nocase">The Analysis of Proximities: Multidimensional Scaling with an Unknown Distance Function. I</span>.”</span> <em>Psychometrika</em> 27: 125–40.
</div>
<div id="ref-shepard_62b" class="csl-entry" role="listitem">
———. 1962b. <span>“<span class="nocase">The Analysis of Proximities: Multidimensional Scaling with an Unknown Distance Function. II</span>.”</span> <em>Psychometrika</em> 27: 219–46.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stability.html" class="pagination-link" aria-label="Stability of MDS Solutions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Stability of MDS Solutions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./software.html" class="pagination-link" aria-label="Software">
        <span class="nav-page-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Software</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>