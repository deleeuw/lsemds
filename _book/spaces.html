<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Stress Spaces â€“ Least Squares Euclidean Multidimensional Scaling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./classical.html" rel="next">
<link href="./properties.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head><body class="nav-sidebar floating">.greybox {
  padding: 1em;
  background: white;
  color: black;
  border: 2px solid orange;
  border-radius: 10px;
}
.center {
  text-align: center;
}

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>





<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./spaces.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stress Spaces</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Least Squares Euclidean Multidimensional Scaling</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Note</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notation and Reserved Symbols</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./properties.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Properties of Stress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spaces.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stress Spaces</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./minimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Minimization of Basic Stress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acceleration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Acceleration of Convergence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonmetric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Nonmetric MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Interval MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./polynomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Polynomial MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ordinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Ordinal MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./splinical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Splinical MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unidimensional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Unidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./full.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Full-dimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unfolding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Unfolding</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./constrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Constrained Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./individual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Individual Differences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./asymmetry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Asymmetry in MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nominal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Nominal MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonordinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Nonmonotonic MDS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonpairs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Compound Objects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sstress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">sstress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rstress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">fstress and rstress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./altls.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Alternative Least Squares Loss</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Inverse Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Stability of MDS Solutions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./global.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">In Search of Global Minima</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Software</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./backmatter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(APPENDIX) Appendices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#propconfspace" id="toc-propconfspace" class="nav-link active" data-scroll-target="#propconfspace"><span class="header-section-number">3.1</span> Configuration Space</a>
  <ul class="collapse">
  <li><a href="#propzerodist" id="toc-propzerodist" class="nav-link" data-scroll-target="#propzerodist"><span class="header-section-number">3.1.1</span> Zero Distance Subspaces</a></li>
  </ul></li>
  <li><a href="#propspherespace" id="toc-propspherespace" class="nav-link" data-scroll-target="#propspherespace"><span class="header-section-number">3.2</span> Spherical Space</a></li>
  <li><a href="#distance-space" id="toc-distance-space" class="nav-link" data-scroll-target="#distance-space"><span class="header-section-number">3.3</span> Distance Space</a></li>
  <li><a href="#squared-distance-space" id="toc-squared-distance-space" class="nav-link" data-scroll-target="#squared-distance-space"><span class="header-section-number">3.4</span> Squared Distance Space</a></li>
  <li><a href="#gramian-space" id="toc-gramian-space" class="nav-link" data-scroll-target="#gramian-space"><span class="header-section-number">3.5</span> Gramian Space</a></li>
  <li><a href="#picsstress" id="toc-picsstress" class="nav-link" data-scroll-target="#picsstress"><span class="header-section-number">3.6</span> Pictures of Stress</a>
  <ul class="collapse">
  <li><a href="#coefficient-space" id="toc-coefficient-space" class="nav-link" data-scroll-target="#coefficient-space"><span class="header-section-number">3.6.1</span> Coefficient Space</a></li>
  <li><a href="#global-perspective" id="toc-global-perspective" class="nav-link" data-scroll-target="#global-perspective"><span class="header-section-number">3.6.2</span> Global Perspective</a></li>
  <li><a href="#global-contour" id="toc-global-contour" class="nav-link" data-scroll-target="#global-contour"><span class="header-section-number">3.6.3</span> Global Contour</a></li>
  <li><a href="#stationary-points" id="toc-stationary-points" class="nav-link" data-scroll-target="#stationary-points"><span class="header-section-number">3.6.4</span> Stationary Points</a></li>
  <li><a href="#second-minimum" id="toc-second-minimum" class="nav-link" data-scroll-target="#second-minimum"><span class="header-section-number">3.6.5</span> Second Minimum</a></li>
  <li><a href="#third-minimum" id="toc-third-minimum" class="nav-link" data-scroll-target="#third-minimum"><span class="header-section-number">3.6.6</span> Third Minimum</a></li>
  <li><a href="#first-saddle-point" id="toc-first-saddle-point" class="nav-link" data-scroll-target="#first-saddle-point"><span class="header-section-number">3.6.7</span> First Saddle Point</a></li>
  <li><a href="#second-saddle-point" id="toc-second-saddle-point" class="nav-link" data-scroll-target="#second-saddle-point"><span class="header-section-number">3.6.8</span> Second Saddle Point</a></li>
  </ul></li>
  <li><a href="#picsphere" id="toc-picsphere" class="nav-link" data-scroll-target="#picsphere"><span class="header-section-number">3.7</span> Another Look</a></li>
  <li><a href="#picline" id="toc-picline" class="nav-link" data-scroll-target="#picline"><span class="header-section-number">3.8</span> A Final Look</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">3.9</span> Discussion</a></li>
  <li><a href="#coordinates" id="toc-coordinates" class="nav-link" data-scroll-target="#coordinates"><span class="header-section-number">3.10</span> Coordinates</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="propspaces" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stress Spaces</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Stress is a function of many variables. Consequently there are many equivalent ways to define it by transforming the parameter space. In this chapter we discuss the major parametrizations that have actually been used. Each has its advantages and disadvantages.</p>
<section id="propconfspace" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="propconfspace"><span class="header-section-number">3.1</span> Configuration Space</h2>
<p>So far we have defined stress on <span class="math inline">\(\mathbb{R}^{n\times p}\)</span>, the space of all matrices with <span class="math inline">\(n\)</span> rows and <span class="math inline">\(p\)</span> columns. We call this <em>configuration space</em>. The usual MDS representation of a dissimilarity matrix is a scatterplot of <span class="math inline">\(n\)</span> points in <span class="math inline">\(p\)</span> dimensions. Therefor there is little doubt that configuration space is the most natural MDS space, and most of our theorems and derivations use this space.</p>
<p>Nevertheless, configuration space has some disadvantages. Even for <span class="math inline">\(n\)</span> as small as four and <span class="math inline">\(p\)</span> as small as two the dimension of the space of configurations is eight, and there is no compelling way to visualize stress as a function of eight variables. Secondly, if we work in configuration space we have to keep the indeterminacies of the representation in mind. Because of translational indeterminacy, minimizing stress over <span class="math inline">\(X\in\mathbb{R}^{n\times p}\)</span> will give the same result as minimizing stress over <span class="math inline">\(X\in\mathbb{R}_C^{n\times p}\)</span>, the <span class="math inline">\(p(n-1)\)</span>-dimensional subspace of all column-centered matrices. Because of translational and rotational indeterminacy it will also give the same result as minimizing stress over <span class="math inline">\(X\in\mathbb{R}_{CT}^{n\times p}\)</span>, the <span class="math inline">\(np-\frac12p(p+1)\)</span> dimensional subspace of all centered lower triangular configurat ions (which have <span class="math inline">\(x_{ij}=0\)</span> for all <span class="math inline">\(j&gt;i\)</span>). Or the same result as minimizing stress over the <span class="math inline">\(np-\frac12p(p+1)\)</span> dimensional nonlinear manifold <span class="math inline">\(\mathbb{R}_{CO}^{n\times p}\)</span> of all centered orthogonal configurations. Especially rotational indeterminacy complicates our analysis of MDS algorithms that operate on configuration space.</p>
<p>Another disadvantage of configuration space is that it needlessly complicates some of our formulas and derivations. Not all pairs of coordinate in a configuration <span class="math inline">\(X\)</span> have the same status. Some pairs belong to the same row of the matrix, and some pairs to different rows. Some pairs of coordinates are in the same column, and some are in different columns. This complicates formulas which depend on considering pairs of coordinates, such as second derivatives.</p>
<p>One way to make a picture in configuration space is to plot the <span class="math inline">\(np\)</span> individual coordinates as functions of a one-dimensional perturbation. In figure @ref(fig:piccoorc) we illustrate this with an example. We have four objects, with all weights and dissimilarities equal, and the <span class="math inline">\(4\times 2\)</span> configuration is an equilateral triangle together with its centroid. Everything is suitably scaled, and we perturb each coordinate using 101 values equally spaced between -1 and +1.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/piccoorc-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>One Coordinate at a Time</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fu">wdef</span>(<span class="dv">4</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">wdef</span>(<span class="dv">4</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> w <span class="sc">/</span> <span class="fu">sum</span>(w)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sum</span> (w <span class="sc">*</span> delta <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> delta <span class="sc">/</span> <span class="fu">sqrt</span> (s)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,.<span class="dv">5</span>,<span class="fu">sqrt</span>(<span class="dv">3</span>)<span class="sc">/</span><span class="dv">2</span>),<span class="dv">3</span>,<span class="dv">2</span>,<span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x, <span class="fu">apply</span>(x, <span class="dv">2</span>, mean))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>, <span class="cf">function</span>(x) x <span class="sc">-</span> <span class="fu">mean</span>(x))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(x))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sum</span> (w <span class="sc">*</span> delta <span class="sc">*</span> d) <span class="sc">/</span> <span class="fu">sum</span> (w <span class="sc">*</span> d <span class="sc">*</span> d)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> x <span class="sc">*</span> s</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">*</span> s</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">smacofR</span>(w,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>            delta,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">p=</span><span class="dv">2</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">xold =</span> x,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">eps=</span><span class="fl">1e-15</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">xstop=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>itel      1  eiff    0.0000000000  sold    0.0334936491  snew    0.0334936491  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">eigen</span>(h<span class="sc">$</span>h)<span class="sc">$</span>values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3.333333e-01  2.559831e-01  2.559831e-01  2.224907e-16  2.146434e-16
[6]  3.456430e-17 -2.151233e-17 -1.812014e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fu">sqrt</span>(<span class="dv">3</span>),<span class="fu">sqrt</span>(<span class="dv">3</span>)<span class="sc">/</span><span class="dv">3</span>),<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="fu">sqrt</span>(<span class="dv">3</span>),<span class="sc">-</span><span class="dv">2</span><span class="sc">-</span><span class="fu">sqrt</span>(<span class="dv">3</span>)<span class="sc">/</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fu">sqrt</span>(<span class="dv">3</span>),<span class="dv">2</span><span class="sc">+</span><span class="fu">sqrt</span>(<span class="dv">3</span>)),<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">0.00001</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(x <span class="sc">+</span> eps <span class="sc">*</span> z))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">smacofLossR</span>(d, w, delta) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2559831</code></pre>
</div>
</div>
<section id="propzerodist" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="propzerodist"><span class="header-section-number">3.1.1</span> Zero Distance Subspaces</h3>
<p>A <em>zero-distance subspace</em> is a subspace of configuration space in which one or more distances are zero. That a zero distance indeed defines a subspace follows from the fact that the nonlinear equation <span class="math inline">\(d_{ij}(X)=0\)</span> is equivalent to the homogeneous linear equation <span class="math inline">\(x_i=x_j\)</span>.</p>
<p>The number of zero-distance subspaces is the same as the number of set partitions of <span class="math inline">\(n\)</span> objects, which is the Bell number <span class="math inline">\(B_n\)</span>. Bell numbers are defined by the recursion <span class="math display">\[\begin{equation}
B_{n+1}=\sum_{k=0}^n\binom{n}{k}B_k,
(\#eq:bellnums)
\end{equation}\]</span> with <span class="math inline">\(B_0=1\)</span>. The next ten Bell numbers <span class="math inline">\(B_1,\cdots,B_{10}\)</span> are 1, 2, 5, 15, 52, 203, 877, 4140, 21147, 11597. So there are lots of zero-distance subspaces.</p>
<p>The gradient in configuration space for all <span class="math inline">\(X\in\mathbb{R}^{n\times p}\)</span> is <span class="math display">\[
\nabla\sigma(X)=(V-B(X))X.
\]</span> <span class="math display">\[
\nabla\tilde\sigma(\theta)=(\tilde V\theta-\tilde B(\theta)\theta)
\]</span> <span class="math display">\[
\frac12\{\nabla\tilde\sigma(\theta)\}_s=\text{tr}\ Y_s'(VX-B(X)X)=\text{tr}\ Y_s'\nabla\sigma(X),
\]</span></p>
<p>with <span class="math inline">\(X=\sum_{s=1}^r\theta_sY_s\)</span>.</p>
<p>Thus <span class="math inline">\(\nabla\tilde\sigma(\theta)=0\)</span> if and only if <span class="math inline">\(\nabla\sigma(X)\in\mathcal{Y}_\perp\)</span>, the subspace of <span class="math inline">\(\mathbb{R}^{n\times p}\)</span> orthogonal to <span class="math inline">\(\mathcal{Y}\)</span>. Specifically <span class="math inline">\(\nabla\sigma(X)=0\)</span> implies <span class="math inline">\(\nabla\tilde\sigma(\theta)=0\)</span>. If the <span class="math inline">\(Y_s\)</span> span all of <span class="math inline">\(\mathbb{R}^{n\times p}\)</span> then <span class="math inline">\(\nabla\tilde\sigma(\theta)=0\)</span> if and only if <span class="math inline">\(\nabla\sigma(X)=0\)</span>.</p>
<p>For the relationship between the minimization problems in coefficient space and configuration space we also study the relationship between the two Hessians.</p>
<p>For all <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span> in configuration space <span class="math display">\[
\frac12\nabla^2\sigma(X)(Z,Z)=\text{tr}\ Z'VZ-\mathop{\sum\sum}_{1\leq i&lt;j\leq n}w_{ij}\frac{\delta_{ij}}{d_{ij}(X)}\left\{\text{tr}\ Z'A_{ij}Z-\frac{\{\text{tr}\ Z'A_{ij}Y\}^2}{d_{ij}^2(X)}\right\}
\]</span></p>
<p>For any <span class="math inline">\(\theta\)</span> in coefficient space <span class="math display">\[
\frac12\nabla^2\tilde\sigma(\theta)=\tilde V-\mathop{\sum\sum}_{1\leq i&lt;j\leq n}w_{ij}\frac{\delta_{ij}}{d_{ij}(\theta)}\left\{\tilde A_{ij}-\frac{\tilde A_{ij}\theta\theta'\tilde A_{ij}}{d_{ij}^2(\theta)}\right\}
\]</span> and thus</p>
<p><span class="math display">\[
\xi'\nabla^2\tilde\sigma(\theta)\xi=\nabla^2\sigma(X)(Z,Z).
\]</span> where <span class="math inline">\(Z:=\sum_{s=1}^r\xi_s Y_s\)</span> and <span class="math inline">\(X:=\sum_{s=1}^r\theta_s Y_s\)</span>.</p>
<p>Thus if <span class="math inline">\(\theta\)</span> is a local minimum in coefficient space then <span class="math inline">\(\nabla^2\sigma(X)\)</span> is positive semi-definite on the subspace <span class="math inline">\(\mathcal{Y}\)</span>. If <span class="math inline">\(X\in\mathcal{Y}\)</span> but <span class="math inline">\(Z\not\in\mathcal{Y}\)</span> it is perfectly possible that <span class="math inline">\(\nabla^2\sigma(X)(Z,Z)&lt;0\)</span>, and thus <span class="math inline">\(X\)</span> can be a saddle point in configuration space. If <span class="math inline">\(X\in\mathcal{Y}\)</span> is a local minimum in configuration space, then <span class="math inline">\(\theta\)</span> is a local minimum in coefficient space. Of course if <span class="math inline">\(\mathcal{Y}\)</span> is the whole space then <span class="math inline">\(\theta\)</span> is a local minimum in coefficient space if and only if <span class="math inline">\(X\)</span> is a local minimum in configuration space.</p>
<p><span class="math display">\[\begin{multline}
\sigma(X(\theta+\epsilon\xi))=\sigma(X(\theta)+\epsilon\mathcal{D}X(\theta)(\xi)+\frac12\epsilon^2\mathcal{D}^2X(\theta)(\xi,\xi))=\\
\sigma(X(\theta))+\epsilon\mathcal{D}\sigma(X(\theta))\mathcal{D}X(\theta)\xi+\frac12\epsilon^2\{\mathcal{D}\sigma(X(\theta))\mathcal{D}^2X(\theta)(\xi,\xi)+\mathcal{D}\sigma(X(\theta))\mathcal{D}\sigma(X(\theta))\}
\end{multline}\]</span></p>
<p><span class="math display">\[
\{\mathcal{D}^2X(\theta)(\xi,\xi)\}_{ip}=\sum\sum\xi_s\xi_t\mathcal{D}_{st}x_{ip}(\theta)=\xi'H_{ip}(\theta)\xi
\]</span> <span class="math display">\[
\{\mathcal{D}X(\theta)(\xi)\}_{ip}=\sum\xi_s\mathcal{D}_sx_{ip}(\theta)=G_{ip}(\theta)\xi
\]</span></p>
<p><span class="math display">\[
\mathcal{D}\sigma(X(\theta))=\{V-B(X(\theta))\}X(\theta)=F(\theta)
\]</span></p>
<p><span class="math display">\[
\mathcal{D}\sigma(\theta)=\mathcal{D}\sigma(X(\theta))\mathcal{D}X(\theta)
\]</span></p>
<p><span class="math inline">\(\sigma(x_{11}(\theta),\cdots,x_{np}(\theta))\)</span></p>
<p><span class="math display">\[
\mathcal{D}_s\sigma(\theta)=\sum_{i=1}^n\sum_{s=1}^p\mathcal{D}_{ip}\sigma(X(\theta))\mathcal{D}_sx_{ip}(\theta)
\]</span></p>
<p><span class="math display">\[
\mathcal{D}_{st}\sigma(\theta)=\sum_{i=1}^n\sum_{s=1}^p
\sum_{j=1}^n\sum_{r=1}^p\mathcal{D}_{is,jr}\sigma(X(\theta))\mathcal{D}_sx_{is}(\theta)\mathcal{D}_tx_{jr}(\theta)
+\sum_{i=1}^n\sum_{s=1}^p\mathcal{D}_{is}\sigma(X(\theta))\mathcal{D}_{st}x_{is}(\theta)
\]</span> Now let <span class="math inline">\(Y_1,Y_2,\cdots,Y_r\)</span> be linearly independent configurations in <span class="math inline">\(\mathbb{R}^{n\times p}\)</span>, and consider minimizing stress over all linear combinations <span class="math inline">\(X\)</span> of the form <span class="math inline">\(X=\sum_{s=1}^r \theta_sY_s\)</span>.</p>
<p>Each linear combination can be identified with a unique vector <span class="math inline">\(\theta\in\mathbb{R}^r\)</span>, the coefficients of the linear combination. Thus we can also formulate our problem as minimizing stress over <em>coefficient space</em>, which is simply <span class="math inline">\(\mathbb{R}^r\)</span>. We write <span class="math inline">\(d_{ij}(\theta)\)</span> for <span class="math inline">\(d_{ij}(X)\)</span> and <span class="math inline">\(\sigma(\theta)\)</span> for <span class="math inline">\(\sigma(X)\)</span>. Note that <span class="math inline">\(d_{ij}(\theta)=\sqrt{\theta'C_{ij}\theta}\)</span>, where <span class="math inline">\(C_{ij}\)</span> has elements <span class="math inline">\(\{C_{ij}\}_{st}:=\text{tr}\ Y_s'A_{ij}Y_t\)</span>.</p>
<p>If the <span class="math inline">\(Y_t\)</span> are actually a basis for configuration space (i.e.&nbsp;if <span class="math inline">\(r=np\)</span>) then minimizing over configuration space and coordinate space is the same thing. For the <span class="math inline">\(Y_t\)</span> we could choose all rank one matrices, for example, of the form <span class="math inline">\(a_i^{\ }b_s'\)</span> where the <span class="math inline">\(a_i\)</span> are a basis for <span class="math inline">\(\mathbb{R}^n\)</span> and the <span class="math inline">\(b_s\)</span> are a basis for <span class="math inline">\(\mathbb{R}^p\)</span>. And, in particular, the <span class="math inline">\(a_i\)</span> and <span class="math inline">\(b_s\)</span> can be chosen as unit vectors of length <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>, respectively. That case we have <span class="math inline">\(C_{ij}=I_p\otimes A_{ij}\)</span>, i.e.&nbsp;the direct sum of <span class="math inline">\(p\)</span> copies of <span class="math inline">\(A_{ij}\)</span>. Also if <span class="math inline">\(\theta=\text{vec}(X)\)</span> then <span class="math inline">\(d_{ij}(X)=\sqrt{\theta'(I_p\otimes A_{ij})\theta}\)</span></p>
<p>If <span class="math inline">\(r&lt;np\)</span> then coefficient space defines a proper subspace of configuration space. If it happens to be the <span class="math inline">\((n -1)p\)</span> dimensional subspace of all column-centered matrices, then the two approaches still define the same minimization problem. But in general <span class="math inline">\(r&lt;(n-1)p\)</span> with the <span class="math inline">\(Y_s\)</span> column-centered defines a <em>constrained MDS problem</em>, which we analyze in more detail in chapter @ref(cmds).</p>
<p>Coefficient space is also a convenient place to deal with rotational indeterminacy in basic MDS. It follows from QR decomposition that any configuration matrix can be rotated in such a way that it upper diagonal elements (the <span class="math inline">\(x_{ij}\)</span> with <span class="math inline">\(i&lt;j\)</span>) are zero (define <span class="math inline">\(X_p\)</span> to be the first <span class="math inline">\(p\)</span> rows of <span class="math inline">\(X\)</span>, compute <span class="math inline">\(X_p'=QR\)</span> with <span class="math inline">\(Q\)</span> square orthonormal and <span class="math inline">\(R\)</span> upper triangular, thus <span class="math inline">\(X_p=R'Q'\)</span> and <span class="math inline">\(X_pQ=R'\)</span>, which is lower triangular). The column-centered upper triangular configurations are a subspace of dimension <span class="math inline">\(p(n-1)-p(p-1)/2\)</span>, and we can choose the <span class="math inline">\(Y_s\)</span> as a basis for this subspace. In this way we eliminate rotational indeterminacy in a relatively inexpensive way.</p>
<p>If <span class="math inline">\(X=\sum_{s=1}^r \theta_sY_s\)</span> then we define the symmetric positive definite matrix <span class="math inline">\(B(\theta)\)</span> of order <span class="math inline">\(r\)</span> with elements</p>
<p><span class="math display">\[\begin{equation}
b_{st}(\theta):=\text{tr}\ Y_s'B(X)Y_t,
(\#eq:propcoefb)
\end{equation}\]</span></p>
<p>where <span class="math inline">\(B(X)\)</span> is the usual B-matrix of order <span class="math inline">\(n\)</span> in configuration space, defined in equation @ref(eq:bdef). Also define <span class="math inline">\(V\)</span> of order <span class="math inline">\(r\)</span> by</p>
<p><span class="math display">\[\begin{equation}
v_{st}:=\text{tr}\ Y_s'VY_t,
(\#eq:propcoefv)
\end{equation}\]</span></p>
<p>where the second <span class="math inline">\(V\)</span>, of order <span class="math inline">\(n\)</span>, is given by equation @ref(eq:vdef). Then</p>
<p><span class="math display">\[\begin{equation}
\sigma(\theta)=1-2\ \theta'B(\theta)\theta+\theta'V\theta.
(\#eq:propcoefs)
\end{equation}\]</span></p>
<p>The relationship between the stationary points in configuration space and coefficient space is fairly straightforward.</p>
<div id="confcoef" class="theorem">
<p>Suppose <span class="math inline">\(\theta\)</span> is in coefficient space and <span class="math inline">\(X=\sum_{s=1}^r\theta_s Y_s\)</span> is the corresponding point in configuration space.</p>
<ol type="1">
<li>If <span class="math inline">\(X\)</span> is a stationary point in configuration space then <span class="math inline">\(\theta\)</span> is a stationary point in coefficient space.</li>
<li>If <span class="math inline">\(\theta\)</span> is a stationary point in coefficient space then <span class="math inline">\(X\)</span> is a stationary point in configuration space if and only if <span class="math inline">\(\text{rank}(Y_1\mid\cdots\mid Y_r)\geq n-1\)</span>. (THIS IS WRONG)</li>
</ol>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>We have <span class="math inline">\(B(X)X=VX\)</span>, i.e.&nbsp; <span class="math display">\[\begin{equation}
\sum_{s=1}^r \theta_s B(X)Y_s=\sum_{s=1}^r \theta_s VY_s.
(\#eq:propfitoff)
\end{equation}\]</span> Premultiplying both sides by <span class="math inline">\(Y_t'\)</span> and taking the trace gives <span class="math inline">\(B(\theta)\theta=V\theta\)</span>. This proves the first part.</p>
<p>For the second part, suppose <span class="math inline">\(B(\theta)\theta=V\theta\)</span> and define <span class="math inline">\(X=\sum_{s=1}^r\theta_s Y_s\)</span>. Then</p>
<p><span class="math display">\[\begin{equation}
\sum_{t=1}^r\text{tr}\ Y_s'(B(X)-V)X=0.
(\#eq:propfftofi)
\end{equation}\]</span></p>
<p>Thus <span class="math inline">\(B(X)X=VX\)</span> if and only if <span class="math inline">\(Y_s'(B(X)-V)X=0\)</span> for all <span class="math inline">\(s\)</span>, which translates to the rank condition in the theorem (this is WRONG, correct).</p>
</div>
<p>The advantage of working in coefficient space is that formulas tend to become more simple. Functions are defined on <span class="math inline">\(\mathbb{R}^r\)</span>, and not a space of matrices, in which some coordinates belong to the same point (row) and others to other points (rows), and some are on the same dimension (column), while others are on different dimensions (columns).</p>
<p>Note that expressions such as @ref(eq:propfitoff) and @ref(eq:propfitoff) simplify if the <span class="math inline">\(Y_s\)</span> are <span class="math inline">\(V\)</span>-orthonormal, i.e.&nbsp;if <span class="math inline">\(\text{tr}\ Y_s'VY_t=\delta^{st}\)</span> and thus <span class="math inline">\(V=I\)</span>. It is easy to generate such an orthonormal set from the original <span class="math inline">\(Y_s\)</span> by using the Gram-Schmidt process. The R function gramy() in utilities.R does exactly that. Coefficient space, which is the span of the <span class="math inline">\(Y_s\)</span>, is not changed by the orthogonalization process.</p>
<p>For a <span class="math inline">\(V\)</span>-orthonormal set <span class="math inline">\(Y\)</span> we have the stationary equations <span class="math inline">\(B(\theta)\theta=\theta\)</span>, which says that <span class="math inline">\(\theta\)</span> is an eigenvector of <span class="math inline">\(B(\theta)\)</span> with eigenvalue 1.</p>
<p>The Hessian is</p>
<p><span class="math display">\[\begin{equation}
\mathcal{D}^2\sigma(\theta)=I-H(\theta),
(\#eq:hessmat)
\end{equation}\]</span></p>
<p>with</p>
<p><span class="math display">\[\begin{equation}
H(\theta):=\mathcal{D}^2\rho(\theta)=\mathop{\sum\sum}_{1\leq i&lt;j\leq n}w_{ij}\frac{\delta_{ij}}{d_{ij}(\theta)}\left\{C_{ij}-\frac{C_{ij}\theta\theta'C_{ij}}{\theta'C_{ij}\theta}\right\}.
(\#eq:rhohessdef)
\end{equation}\]</span></p>
<p>We have <span class="math inline">\(0\lesssim H(\theta)\lesssim B(\theta)\)</span> and thus <span class="math inline">\(I-B(\theta)\lesssim\mathcal{D}^2\sigma(\theta)\lesssim I\)</span>.</p>
<p>Hessian in coef and conf space</p>
</section>
</section>
<section id="propspherespace" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="propspherespace"><span class="header-section-number">3.2</span> Spherical Space</h2>
<p><span class="math display">\[\begin{equation}
\min_X\sigma(X)=\min_{\lambda\geq 0}\min_{\eta^2(X)=1}\sigma(\lambda X)=\min_{\eta^2(X)=1}\min_{\lambda\geq 0}\sigma(\lambda X)=
\min_{\eta^2(X)=1}1-\rho^2(X).
(\#eq:homequ)
\end{equation}\]</span></p>
<p>We see that basic MDS can also be formulated as maximization of <span class="math inline">\(\rho\)</span> over the ellipsoid <span class="math inline">\(\{X\mid \eta^2(X)=1\}\)</span> or, equivalently, over the convex ellipsoidal disk <span class="math inline">\(\{X\mid \eta^2(X)\leq 1\}\)</span>. A similar formulation is available in coefficient space.</p>
<p>This shows that the MDS problem can be seen as a rather special nonlinear eigenvalue problem. <span class="citation" data-cites="guttman_68">Guttman (<a href="references.html#ref-guttman_68" role="doc-biblioref">1968</a>)</span> also discusses the similarities of MDS and eigenvalue problems, in particular as they relate to the power method. In linear eigenvalue problems we maximize a convex quadratic form, in the MDS problem we maximize the homogeneous convex function <span class="math inline">\(\rho\)</span>, in both cases over an ellipsoidal disk. The sublevel sets of <span class="math inline">\(\rho\)</span> defined as <span class="math inline">\(\mathcal{L}_r:=\{X\mid \rho(X)\leq r\}\)</span> are nested convex sets containing the origin. The largest of these sublevel sets that still intersects the ellipsoid <span class="math inline">\(\eta^2(X)=1\)</span> corresponds to the global minimum of stress.</p>
<p>In two and maybe three dimensions graphical method.</p>
<p><span class="math inline">\(\alpha X+\beta Y\)</span> in sphere space one-dimensional</p>
</section>
<section id="distance-space" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="distance-space"><span class="header-section-number">3.3</span> Distance Space</h2>
<p><span class="math display">\[
\sigma(D)=\min_{D\in\mathbb{D}}\mathop{\sum\sum}_{1\leq i&lt;j\leq n} w_{ij}(\delta_{ij}-d_{ij})^2.
\]</span> <span class="math inline">\(\mathbb{D}\)</span> is the set of <span class="math inline">\(p\)</span>-dimensional Euclidean distance matrices, which is not convex.</p>
<p><span class="math inline">\(\mathbb{D}\)</span> is the set of Euclidean distance matrices, which is not convex.</p>
<p>If <span class="math inline">\(D_1\times D_2=0\)</span> then they span a convex cone.</p>
<p><span class="math display">\[
\tau(\alpha D_1+(1-\alpha)D_2)^{(2)})=\alpha^2 \tau(D_1^2)+(1-\alpha)^2\tau(D_2^2)+2\alpha(1-\alpha)\tau(D_1\times D_2)
\]</span> So if <span class="math inline">\(\tau(D_1\times D_2)\gtrsim 0\)</span> convex.</p>
<p><span class="math inline">\(\mathbb{D}\)</span> is the set of distance matrices, which is convex.</p>
<p>Distance matrices are defined by linear inequalities.</p>
<p><span class="math inline">\(\mathbb{D}\)</span> is the set of ultrametric matrices, <span class="math inline">\(d_{ij}\leq\max(d_{ik},d_{jk})\)</span>, which is not convex.</p>
<p>If <span class="math inline">\(D\in\mathbb{D}\)</span> then <span class="math inline">\(\sqrt{D}\in\mathbb{D}\)</span></p>
</section>
<section id="squared-distance-space" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="squared-distance-space"><span class="header-section-number">3.4</span> Squared Distance Space</h2>
<p><span class="math display">\[
\min_{D\in\mathbb{E}}\mathop{\sum\sum}_{1\leq i&lt;j\leq n}w_{ij}(\delta_{ij}-d_{ij})^2.
\]</span> <span class="math inline">\(\mathbb{E}\)</span> is the set of squared Euclidean distance matrices, which is convex.</p>
<p>If <span class="math inline">\(E\in\mathbb{E}\)</span> then <span class="math inline">\(\sqrt{E}\in\mathbb{D}\)</span></p>
</section>
<section id="gramian-space" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="gramian-space"><span class="header-section-number">3.5</span> Gramian Space</h2>
<p>We can write <span class="math inline">\(d_{ij}^2(X)=\text{tr}\ X'A_{ij}X = \text{tr}\ A_{ij}C,\)</span> with <span class="math inline">\(C=XX'\)</span>. This shows minimizing stress can also be formulated as minimizing</p>
<p><span class="math display">\[\begin{equation}
\sigma(C)=1+\text{tr}\ VC-2\mathop{\sum\sum}_{1\leq i&lt;j\leq n}w_{ij}\delta_{ij}\sqrt{\text{tr}\ A_{ij}C}
(\#eq:stresspsd)
\end{equation}\]</span></p>
<p>over all <span class="math inline">\(C\gtrsim 0\)</span> of rank <span class="math inline">\(r\leq p\)</span>.</p>
</section>
<section id="picsstress" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="picsstress"><span class="header-section-number">3.6</span> Pictures of Stress</h2>
<p>Even for <span class="math inline">\(n\)</span> as small as four and <span class="math inline">\(p\)</span> as small as two the dimension of the space of centered configurations is six, and there is no natural way to visualize a function of six variables. What we can do is plot stress on two-dimensional subspaces, either as a contour plot or as a perspective plot. Our two-dimensional subspaces are of the form <span class="math inline">\(\alpha X+\beta Y\)</span>, where <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are fixed configurations. Much of this chapter is a modified, and in some places expanded, version of <span class="citation" data-cites="deleeuw_E_16l">De Leeuw (<a href="references.html#ref-deleeuw_E_16l" role="doc-biblioref">2016</a>)</span>.</p>
<p>Throughout we use a small example of order <span class="math inline">\(n=4\)</span> which all dissimilarities equal. The same example has been analyzed by <span class="citation" data-cites="deleeuw_A_88b">De Leeuw (<a href="references.html#ref-deleeuw_A_88b" role="doc-biblioref">1988</a>)</span>, <span class="citation" data-cites="deleeuw_R_93c">De Leeuw (<a href="references.html#ref-deleeuw_R_93c" role="doc-biblioref">1993</a>)</span>, <span class="citation" data-cites="trosset_mathar_97">Trosset and Mathar (<a href="references.html#ref-trosset_mathar_97" role="doc-biblioref">1997</a>)</span>, and <span class="citation" data-cites="zilinskas_podlipskyte_03">Zilinskas and Poslipskyte (<a href="references.html#ref-zilinskas_podlipskyte_03" role="doc-biblioref">2003</a>)</span>. For this example a global minimum in two dimensions has its four points in the corners of a square. That is our <span class="math inline">\(X\)</span>, which has stress 0.0285955. Our <span class="math inline">\(Y\)</span> is another stationary point, which has three points in the corners of an equilateral triangle and the fourth point in the center of the triangle. Its stress is 0.0669873. We column-center the configurations and scale them so that they are actually stationary points, i.e.&nbsp;so that <span class="math inline">\(\eta^2(X)=\rho(X)\)</span> and <span class="math inline">\(\eta^2(Y)=\rho(Y)\)</span>. The example is chosen in such a way that there are non-zero <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> such that <span class="math inline">\(d_{12}(\alpha X+\beta Y)=0\)</span>. In fact <span class="math inline">\(d_{12}\)</span> is the only distance that can be made zero by a non-trivial linear combination.</p>
<p>Another way of looking at the two configurations is that <span class="math inline">\(X\)</span> are four points equally spaced on a circle, and <span class="math inline">\(Y\)</span> are three points equally spaced on a circle with the fourth point in the center of the circle. <span class="citation" data-cites="deleeuw_A_88b">De Leeuw (<a href="references.html#ref-deleeuw_A_88b" role="doc-biblioref">1988</a>)</span> erroneously claims that <span class="math inline">\(Y\)</span> is a non-isolated local minimum of stress, but <span class="citation" data-cites="trosset_mathar_97">Trosset and Mathar (<a href="references.html#ref-trosset_mathar_97" role="doc-biblioref">1997</a>)</span> have shown there exists a descent direction at <span class="math inline">\(Y\)</span>, and thus <span class="math inline">\(Y\)</span> is actually a saddle point. Of course the stationary points defined by <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are far from unique, because we can permute the four points over the corners of the square and the triangle in many ways.</p>
<section id="coefficient-space" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="coefficient-space"><span class="header-section-number">3.6.1</span> Coefficient Space</h3>
<p>Configurations as a linear combination of a number of given configurations have already been discussed in general in chapter @ref(propchapter), section @ref(propspaces) as the transformation from configuration space to coefficient space. Since we are dealing here with the special case of linear combinations of only two configurations we specialize some of these general results.</p>
<p>We start with <span class="math inline">\(d_{ij}^(\theta)=\theta'T_{ij}\theta\)</span>, where <span class="math inline">\(\theta\)</span> has elements <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, and where <span class="math inline">\(T\)</span> is the <span class="math inline">\(2\times 2\)</span> matrix with elements <span class="math display">\[\begin{equation}
t_{ij}:=\begin{bmatrix}
\text{tr}\ X'A_{ij}X&amp;\text{tr}\ X'A_{ij}Y\\
\text{tr}\ Y'A_{ij}X&amp;\text{tr}\ Y'A_{ij}Y
\end{bmatrix}
(\#eq:pictbform)
\end{equation}\]</span></p>
<p>Then</p>
<p><span class="math display">\[\begin{equation}
\tilde\sigma(\theta):=1-2\ \theta'C(\theta)\theta+\theta'U\theta,
(\#eq:picstress2)
\end{equation}\]</span></p>
<p>where, using <span class="math inline">\(Z(\theta)=\alpha X+\beta Y\)</span>,</p>
<p><span class="math display">\[\begin{equation}
C(\theta):=
\begin{bmatrix}
\text{tr}\ X'B(Z(\theta))X&amp;\text{tr}\ X'B(Z(\theta))Y\\
\text{tr}\ Y'B(Z(\theta))X&amp;\text{tr}\ Y'B(Z(\theta))Y
\end{bmatrix},
(\#eq:pictbformc)
\end{equation}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{equation}
U:=\begin{bmatrix}
\text{tr}\ X'VX&amp;\text{tr}\ X'VY\\
\text{tr}\ Y'VX&amp;\text{tr}\ Y'VY
\end{bmatrix}.
(\#eq:pictbformu)
\end{equation}\]</span></p>
<p>We have used <span class="math inline">\(\tilde\sigma\)</span> in equation @ref(eq:picstress2) to distinguish stress on the two-dimensional space of coefficients from stress on the eight-dimensional space of <span class="math inline">\(4\times 2\)</span> configurations. Thus <span class="math inline">\(\tilde\sigma(\alpha,\beta)=\sigma(\alpha X + \beta Z)\)</span>.</p>
<p>The gradient at <span class="math inline">\(\theta\)</span> is</p>
<p><span class="math display">\[\begin{equation}
\nabla\tilde\sigma(\theta)=U\theta-C(\theta)\theta,
(\#eq:picgrad2)
\end{equation}\]</span></p>
<p>and the Hessian is</p>
<p><span class="math display">\[\begin{equation}
\nabla^2\tilde\sigma(\theta)=U-\mathop{\sum\sum}_{1\leq i&lt;j\leq n}
w_{ij}\frac{\delta_{ij}}{d_{ij}(\theta)}\left\{T_{ij}-\frac{T_{ij}\theta\theta'T_{ij}}{\theta'T_{ij}\theta}\right\}.
(\#eq:pichess2)
\end{equation}\]</span></p>
<hr>
<div id="pictpreserve" class="theorem">
<p>If <span class="math inline">\(B(X)X=VX\)</span> and <span class="math inline">\(\theta=\begin{bmatrix}1&amp;0\end{bmatrix}\)</span> then <span class="math inline">\(C(\theta)\theta=U\theta\)</span>.</p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>If <span class="math inline">\(B(X)X=VX\)</span> and <span class="math inline">\(\theta=\begin{bmatrix}1&amp;0\end{bmatrix}\)</span> then, by equations @ref(eq:pictbformc) and @ref(eq:pictbformu),</p>
<p><span class="math display">\[\begin{equation}
U-C(\theta)=\begin{bmatrix}0&amp;0\\0&amp;\text{tr}\ Y'(V-B(X))Y\end{bmatrix}.
(\#eq:picuminc)
\end{equation}\]</span></p>
<p>Thus <span class="math inline">\((U-C(\theta))\theta=0\)</span>.</p>
</div>
<hr>
<p>Thus each stationary point of <span class="math inline">\(\sigma\)</span> gives a stationary point of <span class="math inline">\(\tilde\sigma\)</span>. The other way around, however, we are not so lucky.</p>
<hr>
<div id="pictaround" class="theorem">
<p>If <span class="math inline">\(C(\theta)\theta=U\theta\)</span> and if the <span class="math inline">\(n\times 2p\)</span> matrix <span class="math inline">\(\begin{bmatrix}X&amp;Y\end{bmatrix}\)</span> has rank <span class="math inline">\(n-1\)</span> then <span class="math inline">\(B(Z)Z=VZ\)</span>.</p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>If <span class="math inline">\(C(\theta)\theta=U\theta\)</span> then both <span class="math inline">\(\text{tr}\ X'(V-B(Z)Z)=0\)</span> and <span class="math inline">\(\text{tr}\ Y'(V-B(Z))Z=0\)</span>. If the <span class="math inline">\(n\times 2p\)</span> matrix <span class="math inline">\(\begin{bmatrix}X&amp;Y\end{bmatrix}\)</span> has rank <span class="math inline">\(n-1\)</span> then this implies <span class="math inline">\((V-B(Z))Z=0\)</span>.</p>
</div>
<hr>
<p>In our example the singular values of <span class="math inline">\(\begin{bmatrix}X&amp;Y\end{bmatrix}\)</span> are 0.4879059, 0.4333287, 0.2242285, 2.256597^{-17} and thus there is a one-one correspondence between stationary points of <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\tilde\sigma\)</span>.</p>
<hr>
<div id="picsecder" class="theorem">
<p>If <span class="math inline">\(B(X)X=VX\)</span> and <span class="math inline">\(\theta=\begin{bmatrix}1&amp;0\end{bmatrix}\)</span> then</p>
<ol type="1">
<li>If <span class="math inline">\(\text{tr}\ Y'(V-B(X))Y &gt; 0\)</span> then <span class="math inline">\(\sigma\)</span> has a local minimum at theta.</li>
<li>If <span class="math inline">\(\sigma\)</span> has a saddle point at <span class="math inline">\(\theta\)</span> then <span class="math inline">\(\text{tr}\ Y'(V-B(X))Y &lt; 0\)</span>.</li>
</ol>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Suppose <span class="math inline">\(B(X)X=VX\)</span> and <span class="math inline">\(\theta=\begin{bmatrix}1&amp;0\end{bmatrix}\)</span>. Then, from @ref(eq:pichess2) and @ref(eq:picuminc), <span class="math display">\[
\nabla^2\sigma(\theta)=\begin{bmatrix}0&amp;0\\0&amp;\text{tr}\ Y'(V-B(X))Y\end{bmatrix}+\mathop{\sum\sum}_{1\leq i&lt;j\leq n}
w_{ij}\frac{\delta_{ij}}{d_{ij}(\theta)}\frac{T_{ij}\theta\theta'T_{ij}}{\theta'T_{ij}\theta}.
\]</span></p>
</div>
<hr>
<p>In our example <span class="math inline">\(\text{tr}\ X'(V-B(Y))X\)</span> is -0.1502768 and <span class="math inline">\(\text{tr}\ Y'(V-B(X))Y\)</span> is -0.0533599.</p>
</section>
<section id="global-perspective" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="global-perspective"><span class="header-section-number">3.6.2</span> Global Perspective</h3>
<p>We first make a global perspective plot, over the range <span class="math inline">\((-2.5,+2.5)\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/globalperspective-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Global Perspective</figcaption>
</figure>
</div>
</div>
</div>
<p>We see the symmetry, following from the fact that stress is even. We also see the local maximum at the origin, where stress is not differentiable. Also note the ridge, where <span class="math inline">\(d_{12}(\theta)=0\)</span> and where stress is not differentiable either. The ridge shows nicely that on rays emanating from the origin stress is a convex quadratic. Also, far away from the origin, stress globally behaves very much like a convex quadratic (except for the ridge). Clearly local minima must be found in the valleys surrounding the small mountain at the origin, all within the sphere with radius <span class="math inline">\(\sqrt{2}\)</span>.</p>
</section>
<section id="global-contour" class="level3" data-number="3.6.3">
<h3 data-number="3.6.3" class="anchored" data-anchor-id="global-contour"><span class="header-section-number">3.6.3</span> Global Contour</h3>
<p>Figure @ref(fig:globalperspective) is a contour plot of stress over <span class="math inline">\((-2,+2)\otimes(-2,+2)\)</span>. The red line is <span class="math inline">\(\{\theta\mid d_{12}(\theta) = 0\}\)</span>. The blue line has the minimum of the convex quadratic on each of the rays through the origin. Thus all local minima, and in fact all stationary points, are on the blue line. Note that the plot uses <span class="math inline">\(\theta\)</span> to define the coordinate axes, not <span class="math inline">\(\gamma=(\alpha,\beta)\)</span>. Thus there are no stationary points at <span class="math inline">\((0,1)\)</span> and <span class="math inline">\((1,0)\)</span>, but at the corresponding points (1.3938469, 0) and (1.0406404, 0.8849253) in the <span class="math inline">\(\theta\)</span> coordinates (and, of course, at their mirror images).</p>
<p>Besides the single local maximum at the origin, it turns out that in this example there are five pairs of stationary points. Or, more precisely, I have not been able to find more than five. Each stationary point <span class="math inline">\(\theta\)</span> has a mirror image <span class="math inline">\(-\theta\)</span>. Three of the five are local minima, two are saddle points. Local minima are plotted as blue points, saddle points as red points.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/globalcontour-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Global Contour</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="stationary-points" class="level3" data-number="3.6.4">
<h3 data-number="3.6.4" class="anchored" data-anchor-id="stationary-points"><span class="header-section-number">3.6.4</span> Stationary Points</h3>
<section id="first-minimum" class="level4" data-number="3.6.4.1">
<h4 data-number="3.6.4.1" class="anchored" data-anchor-id="first-minimum"><span class="header-section-number">3.6.4.1</span> First Minimum</h4>
<p>We zoom in on the first local minimum at (1.0406404, 0.8849253). Its stress is 0.0669873, and the corresponding configuration has three points in the corners of an equilateral triangle and the fourth point in its centroid. Note that this local minimum is a saddle point in configuration space <span class="math inline">\(\mathbb{R}^{4\times 2}\)</span> (<span class="citation" data-cites="trosset_mathar_97">Trosset and Mathar (<a href="references.html#ref-trosset_mathar_97" role="doc-biblioref">1997</a>)</span>). The eigenvalues of <span class="math inline">\(B(\theta)\)</span> are (1.3686346, 1) and those of the Hessian <span class="math inline">\(I-H(\theta)\)</span> are (1, 0.0817218). The area of the contour plot around the stationary value is in figure @ref(fig:contfirstmin).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/contfirstmin-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Contour Plot First Minimum</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="second-minimum" class="level3" data-number="3.6.5">
<h3 data-number="3.6.5" class="anchored" data-anchor-id="second-minimum"><span class="header-section-number">3.6.5</span> Second Minimum</h3>
<p>The second local minimum (which is the global minimum) at (1.3938469, 0) has stress 0.0285955. The configuration are the four points at the corners of a square. The eigenvalues of <span class="math inline">\(B(\theta)\)</span> are (1.1362799, 1) and those of the Hessian <span class="math inline">\(I-H(\theta)\)</span> are (1, 0.3743105). The area of the contour plot around the stationary value is in figure @ref(fig:contsecmin).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/contsecmin-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Contour Plot Second Minimum</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="third-minimum" class="level3" data-number="3.6.6">
<h3 data-number="3.6.6" class="anchored" data-anchor-id="third-minimum"><span class="header-section-number">3.6.6</span> Third Minimum</h3>
<p>The third local minimum at (0.1096253, 1.3291942) has stress 0.1106125, and the corresponding configuration is in figure @ref(fig:confthirdmin).</p>
<hr>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/confthirdmin-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Configuration Third Minimum</figcaption>
</figure>
</div>
</div>
</div>
<p>The eigenvalues of <span class="math inline">\(B(\theta)\)</span> are (1.5279386, 1) and those of the Hessian <span class="math inline">\(I-H(\theta)\)</span> are (1, 0.2362079). The area of the contour plot around the stationary value is in figure @ref(fig:contthirdmin)</p>
<hr>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/contthirdmin-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Contour Plot Third Minimum</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="first-saddle-point" class="level3" data-number="3.6.7">
<h3 data-number="3.6.7" class="anchored" data-anchor-id="first-saddle-point"><span class="header-section-number">3.6.7</span> First Saddle Point</h3>
<p>The saddle point at (0.3253284, 1.2916758) has stress 0.1128675, and the corresponding configuration is in figure @ref(fig:conffirstsad).</p>
<hr>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/conffirstsad-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Configuration First Saddlepoint</figcaption>
</figure>
</div>
</div>
</div>
<p>The eigenvalues of <span class="math inline">\(B(\theta)\)</span> are (1.7778549, 1) and those of the Hessian <span class="math inline">\(I-H(\theta)\)</span> are (1, -0.311088). The area of the contour plot around the stationary value is in figure @ref(fig:contfirstsad)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/contfirstsad-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Contour First Saddlepoint</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="second-saddle-point" class="level3" data-number="3.6.8">
<h3 data-number="3.6.8" class="anchored" data-anchor-id="second-saddle-point"><span class="header-section-number">3.6.8</span> Second Saddle Point</h3>
<p>The saddle point at (1.1238371, 0.7762046) has stress 0.0672483 and the corresponding configuration is in figure @ref(fig:confsecsad)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/confsecsad-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Configuration Second Saddlepoint</figcaption>
</figure>
</div>
</div>
</div>
<p>The eigenvalues of <span class="math inline">\(B(\theta)\)</span> are (1.4111962, 1) and those of the Hessian <span class="math inline">\(I-H(\theta)\)</span> are (1, -0.0841169). The area of the contour plot around the stationary value is in figure @ref(fig:contsecsad)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/contsecsad-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Contour Plot Second Saddlepoint</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="picsphere" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="picsphere"><span class="header-section-number">3.7</span> Another Look</h2>
<p>Remember that <span class="math inline">\(\rho(\theta)=\theta'B(\theta)\theta\)</span>. Thus <span class="math inline">\(\sigma(\lambda\theta)=1-\lambda\rho(\theta)+\frac12\lambda^2\theta'\theta\)</span>, and <span class="math display">\[
\min_\lambda\sigma(\lambda\theta)=1-\frac12\frac{\rho^2(\theta)}{\theta'\theta}.
\]</span> Thus we can minimize <span class="math inline">\(\sigma\)</span> over <span class="math inline">\(\theta\)</span> by maximizing <span class="math inline">\(\rho\)</span> over the unit circle <span class="math inline">\(\mathcal{S}:=\{\theta\mid\theta'\theta=1\}\)</span>. This is a nice formulation, because <span class="math inline">\(\rho\)</span> is norm, i.e.&nbsp;a homogeneous convex function of <span class="math inline">\(\theta\)</span>. Consequently we have transformed the problem from unconstrained minimization of the DC function (i.e.&nbsp;difference of convex functions) stress to that of maximization of a ratio of norms. In turn this is equivalent to maximization of the convex function <span class="math inline">\(\rho\)</span> over the unit circle, or, again equivalently, over the unit ball, a compact convex set. This transform was first used in MDS by <span class="citation" data-cites="deleeuw_C_77">De Leeuw (<a href="references.html#ref-deleeuw_C_77" role="doc-biblioref">1977</a>)</span>, partly because it made the theory developed by <span class="citation" data-cites="robert_67">Robert (<a href="references.html#ref-robert_67" role="doc-biblioref">1967</a>)</span> available.</p>
<p>The levels sets <span class="math inline">\(\{\theta\mid\rho(\theta)=\kappa\}\)</span> are the <span class="math inline">\(\rho\)</span>-circles defined by the norm <span class="math inline">\(\rho\)</span>. The corresponding <span class="math inline">\(\rho\)</span>-balls <span class="math inline">\(\{\theta\mid\rho(\theta)\leq\kappa\}\)</span> are closed and nested convex sets containing the origin. Thus we want to find the largest <span class="math inline">\(\rho\)</span>-circle that still intersects <span class="math inline">\(\mathcal{S}\)</span>. The similarity with the geometry of eigenvalue problems is obvious.</p>
<p>In our example we know that the global optimum of stress is at (1.3938469, 0), and if we project that point on the circle it becomes (1, 0). The corresponding optimal <span class="math inline">\(\rho\)</span> is 1.3938469. Figure @ref(fig:rhocontour) gives the contourplot for <span class="math inline">\(\rho\)</span>, with the outer <span class="math inline">\(\rho\)</span>-circle corresponding with the optimal value. The fact that the optimal value contour is disjoint from the interior of <span class="math inline">\(\mathcal{S}\)</span> is necessary and sufficient for global optimality (<span class="citation" data-cites="dur_horst_locatelli_98">DÃ¼r, Horst, and Locatelli (<a href="references.html#ref-dur_horst_locatelli_98" role="doc-biblioref">1998</a>)</span>). Notice the sharp corners in the contour plot, showing the non-diffentiability of <span class="math inline">\(\rho\)</span> at the points where <span class="math inline">\(d_{12}(\theta)=0\)</span>. We could also look for the minimum of <span class="math inline">\(\rho\)</span> on the unit circle, which means finding the largest <span class="math inline">\(\rho\)</span>-circle that touches <span class="math inline">\(\mathcal{S}\)</span> on the inside. Inspecting figure @ref(fig:rhocontour) shows that this will be a point where <span class="math inline">\(\rho\)</span> is not differentiable, i.e. a point with <span class="math inline">\(d_{12}(\theta)=0\)</span>. This minimum <span class="math inline">\(\rho\)</span> problem does not make much sense in the context of multidimensional scaling, however, and it not related directly to the minimization of stress.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/rhocontour-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Contour Plot for Rho</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="picline" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="picline"><span class="header-section-number">3.8</span> A Final Look</h2>
<p>Now that we know that the MDS problem is equivalent to maximizing <span class="math inline">\(\rho\)</span> on the unit circle, we can use nonlinear coordinates <span class="math inline">\((\theta_1,\theta_2)=(\sin\xi,\cos\xi)\)</span> to reduce the problem to a one-dimensional unconstrained one in, say, ``circle spaceâ€™â€™. Thus, with the same abuse of notation as for stress, <span class="math inline">\(\rho(\xi):=\rho(\sin\xi,\cos\xi)\)</span>, and we have to maximize <span class="math inline">\(\rho\)</span> over <span class="math inline">\(0\leq\xi\leq\pi\)</span>.</p>
<p>In figure @ref(fig:rhononlinearplot) we have plotted <span class="math inline">\(\rho\)</span> as a function of <span class="math inline">\(\eta\)</span>. There are blue vertical lines at the three local minima in coefficient space, red vertical lines at the stationary points, and a green vertical line where <span class="math inline">\(d_{12}(\xi)=0\)</span>. Note that in circle space stress has both multiple local minima and multiple local maxima.</p>
<hr>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/rhononlinearplot-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>One-dimensional Rho</figcaption>
</figure>
</div>
</div>
</div>
<p>From lemma xxx we see that the second derivative <span class="math inline">\(\mathcal{D}^2\rho(\xi)\)</span> is equal to <span class="math inline">\(\mathbf{tr}\ H(\xi)-\rho(\xi)\)</span>. For the three local minima in coordinate space we find second derivatives 0, 0, 0 in circle space, i.e.&nbsp;they are properly converted to local maxima. The two stationary points in coordinate space have second derivatives 0, 0, and are turned into local minima.</p>
<p>For more general cases, with a basis of <span class="math inline">\(n\)</span> configurations, we know from <span class="citation" data-cites="lyusternik-schnirelmann_34">Lyusternik and Schnirelmann (<a href="references.html#ref-lyusternik-schnirelmann_34" role="doc-biblioref">1934</a>)</span> that a continuously differentiable even function on the unit sphere in <span class="math inline">\(\mathbb{R}^n\)</span> has at least <span class="math inline">\(n\)</span> distinct pairs of stationary points.</p>
</section>
<section id="discussion" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="discussion"><span class="header-section-number">3.9</span> Discussion</h2>
<p>Note that we have used <span class="math inline">\(\sigma\)</span> for three different functions. The first one with argument <span class="math inline">\(Z\)</span> is defined on <em>configuration space</em>, the second one with argument <span class="math inline">\(\gamma\)</span> on <em>coefficient space</em>, and the third one with argument <span class="math inline">\(\theta\)</span> also on <em>coefficient space</em>. This is a slight abuse of notation, rather innocuous, but we have to keep it in mind.</p>
<p>From lemma xxx we see that <span class="math inline">\(\mathcal{D}\sigma(X)=\mathcal{D}\sigma(Y)=0\)</span> then <span class="math inline">\(\mathcal{D}\sigma(1,0)=\mathcal{D}\sigma(0,1)=0\)</span>. Thus stationary points in configuration space are preserved as stationary points in coefficient space, but the reverse implication may not be true. If <span class="math inline">\(\mathcal{D}^2\sigma(X)\)</span> and <span class="math inline">\(\mathcal{D}^2\sigma(Y)\)</span> are positive semi-definite, then so are <span class="math inline">\(\mathcal{D}^2\sigma(1,0)\)</span> and <span class="math inline">\(\mathcal{D}^2\sigma(0,1)\)</span>. Thus local minima are preserved. But it is entirely possible that <span class="math inline">\(\mathcal{D}^2\sigma(X)\)</span> and/or <span class="math inline">\(\mathcal{D}^2\sigma(Y)\)</span> are indefinite, and that <span class="math inline">\(\mathcal{D}^2\sigma(1,0)\)</span> and/or <span class="math inline">\(\mathcal{D}^2\sigma(0,1)\)</span> are positive semi-definite. Thus saddle points in configuration space can be mapped into local minima in coefficient space. As we will see this actually happens with <span class="math inline">\(Y\)</span>, the equilateral triangle with center, in our example.</p>
</section>
<section id="coordinates" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="coordinates"><span class="header-section-number">3.10</span> Coordinates</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="spaces_files/figure-html/coordinates1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="spaces_files/figure-html/coordinates2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Letâ€™s look at a small example with four points, all dissimilarities equal, and all weights equal to one. There is a local minimum with four points in the corners of a square, with stress equal to 0.0285955. And there is another local minimum with three points forming an equilateral triangle, and the fourth point in the center. This has stress 0.0669873. We can compute stress for all points of the form <span class="math inline">\(\alpha X+\beta Y\)</span>, where <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are the two local minima. Figure @ref(fig:equalcontourplot) has a contour plot of <span class="math inline">\(\sigma(\alpha,\beta)\)</span>, showing the local minima at <span class="math inline">\((1,0)\)</span> and <span class="math inline">\((0,1)\)</span>, and the local maximum at <span class="math inline">\((0,0)\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/equalcontourplot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Plane spanned by two local minima, equal dissimilarities</figcaption>
</figure>
</div>
</div>
</div>
<p>Alternatively, we can plot stress on the line connecting <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. Note that although stress only has a local maximum at the origin in configuration space, it can very well have local maxima if restricted to lines. In fact on a line connecting two local minima there has to be at least one local maximum.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="spaces_files/figure-html/equallineplot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Line connecting two local minima, equal dissimilarities</figcaption>
</figure>
</div>
</div>
</div>
<p>A fundamental result, which forms the basis of chapter @ref(fullchapter) in this book, is that <span class="math inline">\(\sigma\)</span> is convex on <em>Gramian Space</em>, i.e.&nbsp;on the closed convex cone of all <span class="math inline">\(C\gtrsim 0\)</span>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-deleeuw_C_77" class="csl-entry" role="listitem">
De Leeuw, J. 1977. <span>â€œApplications of Convex Analysis to Multidimensional Scaling.â€</span> In <em>Recent Developments in Statistics</em>, edited by J. R. Barra, F. Brodeau, G. Romier, and B. Van Cutsem, 133â€“45. Amsterdam, The Netherlands: North Holland Publishing Company.
</div>
<div id="ref-deleeuw_A_88b" class="csl-entry" role="listitem">
â€”â€”â€”. 1988. <span>â€œConvergence of the Majorization Method for Multidimensional Scaling.â€</span> <em>Journal of Classification</em> 5: 163â€“80.
</div>
<div id="ref-deleeuw_R_93c" class="csl-entry" role="listitem">
â€”â€”â€”. 1993. <span>â€œFitting Distances by Least Squares.â€</span> Preprint Series 130. Los Angeles, CA: UCLA Department of Statistics. <a href="https://jansweb.netlify.app/publication/deleeuw-r-93-c/deleeuw-r-93-c.pdf">https://jansweb.netlify.app/publication/deleeuw-r-93-c/deleeuw-r-93-c.pdf</a>.
</div>
<div id="ref-deleeuw_E_16l" class="csl-entry" role="listitem">
â€”â€”â€”. 2016. <span>â€œPictures of Stress.â€</span> 2016.
</div>
<div id="ref-dur_horst_locatelli_98" class="csl-entry" role="listitem">
DÃ¼r, M., R. Horst, and M. Locatelli. 1998. <span>â€œ<span class="nocase">Necessary and Sufficient Global Optimality Conditions for Convex Maximization Revisited</span>.â€</span> <em>Journal of Mathematical Analysis and Applications</em> 217: 637â€“49.
</div>
<div id="ref-guttman_68" class="csl-entry" role="listitem">
Guttman, L. 1968. <span>â€œ<span class="nocase">A General Nonmetric Technique for Fitting the Smallest Coordinate Space for a Configuration of Points</span>.â€</span> <em>Psychometrika</em> 33: 469â€“506.
</div>
<div id="ref-lyusternik-schnirelmann_34" class="csl-entry" role="listitem">
Lyusternik, L., and L. Schnirelmann. 1934. <em>M<span>Ã©</span>thodes Topologiues Dans Les Probl<span>Ã¨</span>mes Variationelle</em>. Hermann.
</div>
<div id="ref-robert_67" class="csl-entry" role="listitem">
Robert, F. 1967. <span>â€œ<span class="nocase">Calcul du Rapport Maximal de Deux Normes sur <span class="math inline">\(\mathbb{R}^n\)</span></span>.â€</span> <em>Revue Francaise dâ€™Automatique, dâ€™Informatique Et De Recherche Operationelle</em> 1: 97â€“118.
</div>
<div id="ref-trosset_mathar_97" class="csl-entry" role="listitem">
Trosset, M. W., and R. Mathar. 1997. <span>â€œ<span class="nocase">On the Existence on Nonglobal Minimizers of the STRESS Criterion for Metric Multidimensional Scaling</span>.â€</span> In <em>Proceedings of the Statistical Computing Section</em>, 158â€“62. Alexandria, VA: American Statistical Association.
</div>
<div id="ref-zilinskas_podlipskyte_03" class="csl-entry" role="listitem">
Zilinskas, A., and A. Poslipskyte. 2003. <span>â€œ<span class="nocase">On Multimodality of the SSTRESS Criterion for Metric Multidimensional Scaling</span>.â€</span> <em>Informatica</em> 14 (1): 121â€“30.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./properties.html" class="pagination-link" aria-label="Properties of Stress">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Properties of Stress</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./classical.html" class="pagination-link" aria-label="Classical Multidimensional Scaling">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Classical Multidimensional Scaling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>